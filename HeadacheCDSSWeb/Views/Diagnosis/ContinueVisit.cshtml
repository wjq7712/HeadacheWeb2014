@{
    ViewBag.Title = "ContinueVisit";
    Layout = "~/Views/Shared/Diagnosis_Layout.cshtml";
}
<div id="OcxContent">
<p id="ocx">
    <object id="Reporter2" classid="clsid:466F909A-0EE1-4F40-A2CA-9906C5E36CB2" width="920"
        height="540">
    </object>
</p>
</div>
<div id="Hplace">

<div id="hplace">
<div id="hpNote"><h>头痛部位选择</h><br></br>
<input type="radio" id="bi"name="position" value="双侧"/>双侧<br></br>
<input type="radio" id="unileft" name="position" value="单侧">左侧为主<br></br>
<input type="radio" id="uniright" name="position" value="单侧">右侧为主
</div>
   <div id="picture">
   <img src="@Href("../../Content/images/phead.jpg")"  id="first" usemap="#Map" alt="text"/>
   <map name="Map" id="Map">
  <area id="p1" shape="poly" title="耳部" coords="247,290,270,310,286,301,289,300,311,285,311,273,314,262,316,247,320,234,318,219,318,202,316,194,313,176,305,168,295,160,284,148,284,148,275,141,272,148,268,149,265,157,263,167,260,175,258,179,258,187,253,202,249,212,246,222,245,224,239,241,235,240,241,271" href="#" />
  <area id="p2" shape="poly" title="枕部" coords="382,95,317,113,277,142,313,173,320,214,317,250,310,287,288,302,364,313,365,298,375,284,381,272,388,258,394,241,405,205,406,188,403,151" href="#"  />
  <area id="p3" shape="poly" title="颈部" coords="362,334,364,313,285,301,208,355,165,389,182,423,189,445,231,446,324,443,346,444,362,444,408,444,413,443,418,440,397,411,386,396,376,374,369,358" href="#"  />
  <area id="p4" shape="poly" title="额部" coords="110,97,103,109,99,122,84,155,105,154,123,164,148,180,171,144,194,122,184,105,149,85,143,79,133,70,119,84" href="#"  />
  <area id="p5" shape="poly" title="顶部" coords="216,37,170,45,131,68,148,84,185,108,190,118,234,134,266,148,313,114,378,94,345,67,319,53,267,39" href="#"  />
  <area id="p6" shape="poly" title="颌部" coords="64,306,61,298,69,284,91,282,119,312,131,325,153,339,203,361,163,389,103,387,84,378,73,362,76,343,67,321,69,313" href="#"  />
  <area id="p7" shape="poly" title="眶部" coords="79,172,83,156,106,155,129,169,145,180,150,192,152,201,150,212,144,220,127,223,104,223,99,215,98,209,99,202,83,184" href="#"  />
  <area id="p8" shape="poly" title="颞部" coords="152,171,147,182,153,203,146,219,174,219,191,225,238,241,245,223,252,202,267,148,232,134,197,119,171,144,164,156" href="#"  />
  <area id="p9" shape="poly" title="脸部" coords="99,223,95,233,91,242,87,252,87,265,91,280,104,294,119,312,140,331,150,335,160,342,197,358,203,358,245,329,271,310,246,289,238,266,236,242,198,228,176,221,158,218,131,224" href="#"  />
</map>

   </div>
   
</div>
</div>
<script type="text/javascript">
$(function () { 
        var obj = eval ("(" + @Html.Raw(Json.Encode(ViewData["data"]))+ ")");
        var patientId= @Html.Raw(Json.Encode(ViewData["id"]));
         var visitId= @Html.Raw(Json.Encode(ViewData["visitId"]));
        var OCX = document.getElementById('Reporter2');
     // debugger;
        SetDataIntoOCX(OCX, obj);
        SetHeadachePlace(obj);

         //头疼部位点击
           $('#p1').click(function (e) {
            e.preventDefault();
            var data = $('#p1').mouseout().data('maphilight') || {};
            data.alwaysOn = !data.alwaysOn;
            $('#p1').data('maphilight', data).trigger('alwaysOn.maphilight');

        });
        $('#p2').click(function (e) {
            e.preventDefault();
            var data = $('#p2').mouseout().data('maphilight') || {};
            data.alwaysOn = !data.alwaysOn;
            $('#p2').data('maphilight', data).trigger('alwaysOn.maphilight');

        });
       $('#p3').click(function (e) {
            e.preventDefault();
            var data = $('#p3').mouseout().data('maphilight') || {};
            data.alwaysOn = !data.alwaysOn;
            $('#p3').data('maphilight', data).trigger('alwaysOn.maphilight');

        });
        $('#p4').click(function (e) {
            e.preventDefault();
            var data = $('#p4').mouseout().data('maphilight') || {};
            data.alwaysOn = !data.alwaysOn;
            $('#p4').data('maphilight', data).trigger('alwaysOn.maphilight');

        });
        $('#p5').click(function (e) {
            e.preventDefault();
            var data = $('#p5').mouseout().data('maphilight') || {};
            data.alwaysOn = !data.alwaysOn;
            $('#p5').data('maphilight', data).trigger('alwaysOn.maphilight');

        });
        $('#p6').click(function (e) {
            e.preventDefault();
            var data = $('#p6').mouseout().data('maphilight') || {};
            data.alwaysOn = !data.alwaysOn;
            $('#p6').data('maphilight', data).trigger('alwaysOn.maphilight');

        });
         $('#p8').click(function (e) {
            e.preventDefault();
            var data = $('#p8').mouseout().data('maphilight') || {};
            data.alwaysOn = !data.alwaysOn;
            $('#p8').data('maphilight', data).trigger('alwaysOn.maphilight');

        });
         $('#p7').click(function (e) {
            e.preventDefault();
            var data = $('#p7').mouseout().data('maphilight') || {};
            data.alwaysOn = !data.alwaysOn;
            $('#p7').data('maphilight', data).trigger('alwaysOn.maphilight');

        });
        $('#p9').click(function (e) {
            e.preventDefault();
            var data = $('#p9').mouseout().data('maphilight') || {};
            data.alwaysOn = !data.alwaysOn;
            $('#p9').data('maphilight', data).trigger('alwaysOn.maphilight');

        });

         ///子菜单 点击
         $(".nav-tabs li a").click(function () {
          $(".on").removeClass("on");
          $(this).parent().addClass("on");
          if($(this).text()=="头痛部位")
          {        $("#btn2").hide();
                   $("#OcxContent").hide();
                   $("#Hplace").show();
          }
          else{
           $("#OcxContent").show();
           $("#Hplace").hide();
           OCX.ShowReport();
           var name=$(this).text();
            OCX.ShowThisPage(name);
            if(name=="头痛概述")
            $("#btn2").show();
             else
             $("#btn2").hide();
          }
           });
       $('#first').maphilight({
            fillColor: '008800'
        });
        $("#Hplace").hide();
        $("#direct ul").hide();
        $("#submenu").hide();

    $("#btn1").click(function () {
            $("#btn2").show();
            var OCX = document.getElementById('Reporter2');
            if($(".selected").last().attr("id") == "基本筛查"){
                var myBoolean=new Boolean(false);
                for(var i =0;i<10;i++)
                {
                    var j=i+1;
                    var Name="CheckBox_"+j.toString();
                    if("true" == OCX.GetObjectInfo(Name, "checked"))
                     {
                       myBoolean=true;
                     }
                 }
               if(myBoolean==true){
                    $(".selected").next().addClass("selected"); 
                    $(".active").next().addClass("active");
                    $(".active").first().removeClass("active");
               }
               else{
               addmenu();      
              }
            }
             if ($(".selected").last().attr("id") == "基本筛查" || $(".selected").last().attr("id") == "头痛问诊")
               {
                OCX.SetObjectInfo("TextBox_12", "text", GetChiefComplaint(OCX));
               }
             if ($(".selected").last().attr("id") == "辅助诊断"||$(".selected").last().attr("id") == "报告预览")
             {
                //set chief complaint
                var strChiefComplaint = OCX.GetObjectInfo("TextBox_12", "text");
                OCX.SetObjectInfo("TextBox_9", "text", strChiefComplaint);
                //set diagnose
                var strDiagnose = "";
                if("" != OCX.GetObjectInfo("ComboBox_31", "text"))
                {
                     if("" != OCX.GetObjectInfo("ComboBox_32", "text"))   
                        strDiagnose = OCX.GetObjectInfo("ComboBox_31", "text") + ":" + OCX.GetObjectInfo("ComboBox_32", "text") + "。  ";
                     else
                        strDiagnose = OCX.GetObjectInfo("ComboBox_31", "text") + "。  ";
                     strDiagnose += "\n";
                }
                if("" != OCX.GetObjectInfo("ComboBox_33", "text"))
                {
                    if("" != OCX.GetObjectInfo("ComboBox_34", "text"))
                        strDiagnose += OCX.GetObjectInfo("ComboBox_33", "text") + ":" + OCX.GetObjectInfo("ComboBox_34", "text") + "。  ";
                    else
                        strDiagnose += OCX.GetObjectInfo("ComboBox_33", "text") + "。  ";
                    strDiagnose += "\n";
                }
                if("" != OCX.GetObjectInfo("ComboBox_36", "text"))
                {
                    if("" != OCX.GetObjectInfo("ComboBox_35", "text"))
                        strDiagnose += OCX.GetObjectInfo("ComboBox_36", "text") + ":" + OCX.GetObjectInfo("ComboBox_35", "text") + "。";
                    else
                        strDiagnose += OCX.GetObjectInfo("ComboBox_36", "text") + "。";
                }
                if("" != strDiagnose)
                    OCX.SetObjectInfo("TextBox_10", "text", strDiagnose);
            }
            if ($(".selected").last().attr("id") == "基本筛查" || $(".selected").last().attr("id") == "头痛问诊"||$(".selected").last().attr("id") == "报告预览")
            {  
               var encoded = $.toJSON(ChangeDataFromOCXIntoJSObject(OCX));
                }
                if($(".selected").last().attr("id") == "报告预览")
                {
                    $("#ocx").hide();
                    $(".active").wBox({title: "提示信息", html: "<div class='demo'><img src='"+'@Url.Content("~/Content/images/wait.gif")'+"'/></div>", show: true  });
                    $.ajax({
                        url: '@Url.Action("Update", "Diagnosis")',
                        type: "POST",
                        data: { postjson: encoded },
                        success: function (data) {
                            if (data.OK) {
                            var OCX = document.getElementById('Reporter2');
                            $(".demo").html("本次问诊信息保存成功！稍候将自动退出"); 
                            var t = setTimeout("  window.location.href = '@Url.Action("Index", "EnterPatInfor")'", 3000);
                            }
                            else {
                            $(".demo").html("抱歉，信息保存出现异常");
                            var t = setTimeout("  window.location.href = '@Url.Action("Index", "EnterPatInfor")'", 2000);
                            }
                        },
                        error: function (jqXhr, textStatus, errorThrown) {
                            alert("Error '" + jqXhr.status + "' (textStatus: '" + textStatus + "', errorThrown: '" + errorThrown + "')");
                        }
                    });
                }
                         else
                         {
                               
                               if($(".selected").last().attr("id")!="头痛问诊")
                       {  
                            $(".selected").next().addClass("selected");
                            var name = $(".selected").last().attr("id");
                            $(".active").next().addClass("active");
                            $(".active").first().removeClass("active");
                            OCX.SetData("Data_source/VisitRecord/CDSSDiagnosis", "        " + "正在推理中。。。");
                            OCX.ShowReport();
                            if(name=="头痛问诊"){
                            name="头痛概述"
                            }
                            else if(name=="医嘱处置")
                            {
                              name=SetDrugPage(OCX);
                            }
                            OCX.ShowThisPage(name);
                            if(name=="报告预览"){
                              //set doctor advice in report
                OCX.SetObjectInfo("TextBox_11", "text", GetDoctorAdvice(OCX));
                            $("#btn1").html("保存并退出");
                             addprint();
                             }
                         }
                         else
                         {
                         debugger;
                         
                          var oDiv=document.createElement("div");
                          var parentdiv = document.getElementById('info');
                          parentdiv.appendChild(oDiv);
                          oDiv.id="annouce";
                          oDiv.style.border="1px solid blue";
                          oDiv.style.width="100px";
                          oDiv.style.height="50px";
                          oDiv.innerHTML="正在推理，请稍等";
                          parentdiv.display="block"
                          oDiv.style.display="block"; 
                         // var imageUrl='@Url.Content("~/Content/images/wait.gif")';
                          $(".active").wBox({title: "提示信息", html: "<div class='demo'><img width='50' height='50' src='"+'@Url.Content("~/Content/images/wait.gif")'+"'/><div class='demo_text'>正在推理中....</div></div>", show: true  });

                                    $.ajax({
                                        url: '@Url.Action("CDSSdiagnosis", "Diagnosis")',
                                        type: "POST",
                                        data: { postjson: encoded,patId:patientId,visitId:visitId},
                                        success: function (data) {
                                            if (data.OK) {
                                                   SetDiagnoses(OCX, data.Message);                                                  
                                                   $(".selected").next().addClass("selected");
                                                   var name = $(".selected").last().attr("id");
                                                   $(".active").next().addClass("active");
                                                    $(".active").first().removeClass("active");
                                                    debugger;
                                                
                                                 var div=document.getElementById("annouce");
                                                  div.parentNode.removeChild(div);
                                                   $("#wBox").remove();
                                                   $("#wBox_overlay").remove();
                                                   
                                                    $("#info").hide();
                                                 // OCX.SetData("Data_source/VisitRecord/CDSSDiagnosis", "        " + "正在推理中。。。");
                                                  deletemenu();
                                                  OCX.ShowReport();
                                                  OCX.ShowThisPage(name);
                                            }
                                            else {
                                                alert(data.Message.toString());
                                                 $("#wBox").remove();
                                                  $("#wBox_overlay").remove();
                                            }

                                        },
                                        error: function (jqXhr, textStatus, errorThrown) {
                                            alert("Error '" + jqXhr.status + "' (textStatus: '" + textStatus + "', errorThrown: '" + errorThrown + "')");
                                        }
                                    });
                               
                            
                         }
                  
                 }
                

        
     });
    });
    function SetDrugPage(OCX)
    {
       var diagnosis=OCX.GetObjectInfo("ComboBox_31", "text");
       switch (diagnosis)
        {
        case "紧张型头痛":
            x="紧张型头痛";
            return x;
            break;
        case "偏头痛":
            x="偏头痛";
            return x;
            break;
        case "丛集性头痛和其他原发性三叉神经痛":
            x="丛集性头痛";
            return x;
            break;
        case "颅神经痛和中枢源性面痛":
            x="神经痛";
            return x;
            break;
        case "慢性每日头痛":
           
            x="慢性每日头痛";
            return x;
            break;
       default:
            x="其他类型头痛";
            return x;
            break;
        }
     }
    function SetDiagnoses(OCX, strDiagnose)
    {
        OCX.SetObjectInfo("TextBox_14", "text", strDiagnose);
        if(strDiagnose.indexOf("偏头痛") >= 0)
        {
            OCX.SetObjectInfo("ComboBox_31", "text", "偏头痛");
            if(strDiagnose.indexOf("很可能的偏头痛") >= 0)
            {
                OCX.SetObjectInfo("ComboBox_32", "text", "很可能的偏头痛");
            }
            else if(strDiagnose.indexOf("无先兆性偏头痛") >= 0)
            {
                OCX.SetObjectInfo("ComboBox_32", "text", "无先兆性偏头痛");
            }
            else if(strDiagnose.indexOf("先兆性偏头痛") >= 0)
            {
                OCX.SetObjectInfo("ComboBox_32", "text", "先兆性偏头痛");
            }
            else if(strDiagnose.indexOf("视网膜性偏头痛") >= 0)
            {
                OCX.SetObjectInfo("ComboBox_32", "text", "视网膜性偏头痛");
            }
            else if(strDiagnose.indexOf("偏头痛的合并症") >= 0)
            {
                OCX.SetObjectInfo("ComboBox_32", "text", "偏头痛的合并症");
            }
        }
        else if(strDiagnose.indexOf("紧张型头痛") >= 0)
        {
            OCX.SetObjectInfo("ComboBox_31", "text", "紧张型头痛");
            if(strDiagnose.indexOf("偶尔发作性紧张型头痛") >= 0)
            {
                OCX.SetObjectInfo("ComboBox_32", "text", "偶尔发作性紧张型头痛");
            }
            else if(strDiagnose.indexOf("频繁发作性紧张型头痛") >= 0)
            {
                OCX.SetObjectInfo("ComboBox_32", "text", "频繁发作性紧张型头痛");
            }
            else if(strDiagnose.indexOf("很可能的紧张型头痛") >= 0)
            {
                OCX.SetObjectInfo("ComboBox_32", "text", "很可能的紧张型头痛");
            }
        }
        else if(strDiagnose.indexOf("丛集性头痛") >= 0)
        {
            OCX.SetObjectInfo("ComboBox_31", "text", "丛集性头痛和其他原发性三叉神经痛");
            OCX.SetObjectInfo("ComboBox_32", "text", "丛集性头痛");
        }
        else if(strDiagnose.indexOf("阵发性偏侧头痛") >= 0)
        {
            OCX.SetObjectInfo("ComboBox_31", "text", "丛集性头痛和其他原发性三叉神经痛");
            OCX.SetObjectInfo("ComboBox_32", "text", "阵发性偏侧头痛");
        }
        else if(strDiagnose.indexOf("SUNCT") >= 0)
        {
            OCX.SetObjectInfo("ComboBox_31", "text", "丛集性头痛和其他原发性三叉神经痛");
            OCX.SetObjectInfo("ComboBox_32", "text", "SUNCT");
        }
        else if(strDiagnose.indexOf("很可能的三叉自主神经性头痛") >= 0)
        {
            OCX.SetObjectInfo("ComboBox_31", "text", "丛集性头痛和其他原发性三叉神经痛");
            OCX.SetObjectInfo("ComboBox_32", "text", "很可能的三叉自主神经性头痛");
        }
        else if(strDiagnose.indexOf("慢性偏头痛") >= 0)
        {
            OCX.SetObjectInfo("ComboBox_31", "text", "慢性每日头痛");
            OCX.SetObjectInfo("ComboBox_32", "text", "慢性偏头痛");
        }
        else if(strDiagnose.indexOf("慢性紧张型头痛") >= 0)
        {
            OCX.SetObjectInfo("ComboBox_31", "text", "慢性每日头痛");
            OCX.SetObjectInfo("ComboBox_32", "text", "慢性紧张型头痛");
        }
        else if(strDiagnose.indexOf("新发每日持续性头痛") >= 0)
        {
            OCX.SetObjectInfo("ComboBox_31", "text", "慢性每日头痛");
            OCX.SetObjectInfo("ComboBox_32", "text", "新发每日持续性头痛");
        }
        else if(strDiagnose.indexOf("药物滥用引起的头痛") >= 0)
        {
            OCX.SetObjectInfo("ComboBox_31", "text", "慢性每日头痛");
            OCX.SetObjectInfo("ComboBox_32", "text", "药物滥用引起的头痛");
        }
        else if(strDiagnose.indexOf("颅神经痛和中枢源性面痛") >= 0)
        {
            OCX.SetObjectInfo("ComboBox_31", "text", "颅神经痛和中枢源性面痛");
        }
    }
     function MapFunction(placeid)
        {
        debugger;
          var data = $(placeid).mouseout().data('maphilight') || {};
           data.alwaysOn = !data.alwaysOn;
           $(placeid).data('maphilight', data).trigger('alwaysOn.maphilight')
        }
        function GetHeadachePlace()
        { 
          var placesid=new Array("#p1","#p2","#p3","#p4","#p5","#p6","#p7","#p8","#p9");
           var places=new Array("耳部","枕部","颈部","额部","顶部","颌部","眶部","颞部","脸部");
          var placevalues=new Array(9);
        
               for (var i=0;i<9;i++)
                {
                  var data = $(placesid[i]).mouseout().data('maphilight') || {};
                    if(data.alwaysOn){
                    placevalues[i]= data.alwaysOn;
                    }
                    else{
                     placevalues[i]=false;
                    }
                 
                }
                return placevalues;
        }
         function addmenu(){
     $("#direct").hide();
    $("#Reporter2").css("height","500");
    $("#submenu").show();
    //$("#ne").before('<div id="submenu" ><ul class="nav-tabs"><li class="on"><a href="#">头痛概述</a></li><li><a href="#">头痛部位</a></li><li><a  href="#" >相关症状</a></li><li><a href="#">既往治疗</a></li><li><a>生活方式</a></li><li><a href="#">家族病史</a></li><li><a href="#">诱发缓解因素</a></li></ul></div>'); 
     }
   function deletemenu(){
      $("#direct").show();
    $("#Hplace").hide();
    $("#submenu").hide();
   $("#Reporter2").css("height","540");
   $("#OcxContent").show();
     }
     function addprint(){ 
   $("#btn1").after('<div id="btn3" class="btn"><a id="b1">打印报告</a></div>'); 
   document.getElementById("btn3").onclick=function(){ PrintReport()};   
   } 
  function deleteprint(){
  $("#btn3").remove();
  }
  function PrintReport() {
        var OCX = document.getElementById('Reporter2');
        OCX.EnableMacroPrint(true);
        OCX.PrintPages("报告预览", false);
    }
    function SetDataIntoOCX(OCX, obj)
    {
    //debugger;//需要确认一下这里的obj数据是不是完整-----没止痛和预防项，主诉信息不好读，有缺失
        //set the data to OCX
        //set patient information
        
        if(null != obj.Name)
            OCX.SetObjectInfo("TextBox_2", "text", obj.Name);
        if(null != obj.Sex)
            OCX.SetObjectInfo("TextBox_3", "text", obj.Sex);
//        if(null != obj.ChiefDoctor)
//            OCX.SetObjectInfo("TextBox_4", "text", obj.ChiefDoctor);
        if(null != obj.Phone)
            OCX.SetObjectInfo("TextBox_6", "text", obj.Phone);
        if(null != obj.Address)
            OCX.SetObjectInfo("TextBox_8", "text", obj.Address);
        var strChiefComplaint = "";

        //set Secondary Headache Symptom如果继续问诊已经有新的原发性头痛诊断结果，则依据visitrecord里试最新的诊断结果
        var strSecondaryHeadacheSymptom = "";
        var lSymptomCount = obj.secondaryheadachesymptom.length;
        //set chief complaint
        if(0 != lSymptomCount)
            strChiefComplaint = "继发性头痛筛查:";
        for(var lSymptomIndex = 0; lSymptomIndex < lSymptomCount; ++lSymptomIndex)
        {
            strSecondaryHeadacheSymptom = obj.secondaryheadachesymptom[lSymptomIndex];
            //set chief complaint
            strChiefComplaint += " ";
            strChiefComplaint += strSecondaryHeadacheSymptom;
            if(obj.ChiefComplaint.indexOf("头痛部位")<0)
            {
                if("突然发生的头痛" == strSecondaryHeadacheSymptom)
                    OCX.SetObjectInfo("CheckBox_1", "checked", "true");
                else if("逐渐加重的头痛" == strSecondaryHeadacheSymptom)
                    OCX.SetObjectInfo("CheckBox_2", "checked", "true");
                else if("伴有系统性病变征象（发热、颈强直、皮疹）的头痛" == strSecondaryHeadacheSymptom)
                    OCX.SetObjectInfo("CheckBox_3", "checked", "true");
                else if("神经系统局灶症状和体征（除典型的视觉、感觉先兆之外）" == strSecondaryHeadacheSymptom)
                    OCX.SetObjectInfo("CheckBox_4", "checked", "true");
                else if("伴有认知障碍的头痛" == strSecondaryHeadacheSymptom)
                    OCX.SetObjectInfo("CheckBox_5", "checked", "true");
                else if("视乳头水肿" == strSecondaryHeadacheSymptom)
                    OCX.SetObjectInfo("CheckBox_6", "checked", "true");
                else if("由咳嗽、用力动作诱发的头痛" == strSecondaryHeadacheSymptom)
                    OCX.SetObjectInfo("CheckBox_8", "checked", "true");
                else if("妊娠期或产后头痛" == strSecondaryHeadacheSymptom)
                    OCX.SetObjectInfo("CheckBox_9", "checked", "true");
                else if("癌症患者或AIDS患者出现新发头痛" == strSecondaryHeadacheSymptom)
                    OCX.SetObjectInfo("CheckBox_10", "checked", "true");
                else if("50岁后的新发头痛" == strSecondaryHeadacheSymptom)
                    OCX.SetObjectInfo("CheckBox_7", "checked", "true");
            } 
        }

        //set the headache overview
        var strOnsetDate = obj.headacheoverview.OnsetDate;
        strChiefComplaint += "最近起病年月：" + strOnsetDate;
        var strFirstOnsetContinue = obj.headacheoverview.FirstOnsetContinue;
        strChiefComplaint += " " + "首次发作即每天头痛：" + strFirstOnsetContinue;
//        var strOnsetFixedDay = obj.headacheoverview.OnsetFixedDay;
//        strChiefComplaint += " " + "每天固定的时间：" + strOnsetFixedDay;
//        var strOnsetFixedYear = obj.headacheoverview.OnsetFixedYear;
//        strChiefComplaint += " " + "每年的固定时间：" + strOnsetFixedYear;
        var strIfFixed = obj.headacheoverview.OnsetFixedPeriod;
        if("是"==strIfFixed)
            strChiefComplaint += " 头痛在某段时间集中发作";
        var strHeadacheDegree = obj.headacheoverview.HeadacheDegree;
        strChiefComplaint += " " + "头痛程度评分：" + strHeadacheDegree;
        var strHeadacheType = obj.headacheoverview.HeadacheType;
        strChiefComplaint += " " + "日常生活是否加重头痛：" + strHeadacheType;
        var strDailyAggravation = obj.headacheoverview.DailyAggravation;
        strChiefComplaint += " " + "头痛疼痛性质：" + strDailyAggravation;
        var strHeadcheTime = obj.headacheoverview.HeadcheTime;
        strChiefComplaint += " " + "每次头痛持续时间：" + strHeadcheTime;
        var strHeacheTimeUnit = obj.headacheoverview.HeacheTimeUnit;
        strChiefComplaint += strHeacheTimeUnit;
        var strOnsetAmount = obj.headacheoverview.OnsetAmount;
        strChiefComplaint += " " + "头痛发作次数：" + strOnsetAmount;
        var strFrequencyPerMonth = obj.headacheoverview.FrequencyPerMonth;
        strChiefComplaint += " " + "最近三个月平均头痛频率：" + strFrequencyPerMonth + "天/每月";
        //var strFrequencyPerDay = obj.headacheoverview.FrequencyPerDay;
        //strChiefComplaint += " " + strFrequencyPerDay + "次/每天";

        //OCX.SetObjectInfo("DateTime_2", "text", strOnsetDate);
        var strOnsetYear = strOnsetDate.substring(0, 4);
        var strOnsetMonth = strOnsetDate.substring(5, 7);
        if(strOnsetMonth.substring(0,1)=='0')
            strOnsetMonth=strOnsetMonth.substring(1,2);
        OCX.SetObjectInfo("TextBox_80", "text", strOnsetYear);
        OCX.SetObjectInfo("TextBox_108", "text", strOnsetMonth);
        OCX.SetObjectInfo("ComboBox_37", "text", strFirstOnsetContinue);
        //OCX.SetObjectInfo("ComboBox_42", "text", strOnsetFixedDay);
        //OCX.SetObjectInfo("ComboBox_24", "text", strOnsetFixedYear);
        OCX.SetObjectInfo("ComboBox_1", "text", strIfFixed);
        OCX.SetObjectInfo("ComboBox_41", "text", strHeadacheDegree);
        OCX.SetObjectInfo("ComboBox_40", "text", strHeadacheType);
        OCX.SetObjectInfo("ComboBox_38", "text", strDailyAggravation);
        OCX.SetObjectInfo("TextBox_40", "text", strHeadcheTime);
        OCX.SetObjectInfo("ComboBox_39", "text", strHeacheTimeUnit);
        if(strOnsetAmount == "类似发作<5次")
            OCX.SetObjectInfo("RadioBox_15", "checked", "true");
        if(strOnsetAmount == "类似发作6-9次")
            OCX.SetObjectInfo("RadioBox_14", "checked", "true");
        if(strOnsetAmount == "类似发作超过10次")
            OCX.SetObjectInfo("RadioBox_12", "checked", "true");
        if(strOnsetAmount == "持续头痛")
            OCX.SetObjectInfo("RadioBox_13", "checked", "true");

        if("<1" == strFrequencyPerMonth)
            OCX.SetObjectInfo("RadioBox_7", "checked", "true");
        else if("1-15" == strFrequencyPerMonth)
            OCX.SetObjectInfo("RadioBox_8", "checked", "true");
        else if(">15" == strFrequencyPerMonth)
            OCX.SetObjectInfo("RadioBox_9", "checked", "true");
        //OCX.SetObjectInfo("ComboBox_18", "text", strFrequencyPerDay);

        //set HeadacheAccompany
        var strHeadacheAccompany = "";
        var lHeadacheAccompanyCount = obj.headacheaccompany.length;

        //set Chief Complaint
        strChiefComplaint += " " + "头痛伴随症状:";

        for(var lHeadacheAccompanyIndex = 0; lHeadacheAccompanyIndex < lHeadacheAccompanyCount; ++lHeadacheAccompanyIndex)
        {
            strHeadacheAccompany = obj.headacheaccompany[lHeadacheAccompanyIndex];
            if("恶心" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_52", "checked", "true");
            else if("呕吐" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_45", "checked", "true");
            else if("畏光" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_44", "checked", "true");
            else if("怕吵" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_41", "checked", "true");
            else if("同侧鼻塞/流涕" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_51", "checked", "true");
            else if("同侧结膜充血/流泪" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_46", "checked", "true");
            else if("同侧前额/面部出汗" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_43", "checked", "true");
            else if("同侧眼睑水肿" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_50", "checked", "true");
            else if("同侧眼睑下垂" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_47", "checked", "true");
            else if("同侧瞳孔缩小" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_42", "checked", "true");
            else if("感觉不安或躁动" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_49", "checked", "true");
            else if("其它" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_48", "checked", "true");
        }

        //set HeadacheProdrome
        var strHeadacheProdrome = "";
        var lHeadacheProdromeCount = obj.headacheprodrome.length;

        //set Chief Complaint
        strChiefComplaint += " " + "头痛先兆:";

        for(var lHeadacheProdromeIndex = 0; lHeadacheProdromeIndex < lHeadacheProdromeCount; ++lHeadacheProdromeIndex)
        {
            strHeadacheProdrome = obj.headacheprodrome[lHeadacheProdromeIndex];

            //set Chief Complaint
            strChiefComplaint += " " + strHeadacheProdrome;

            if("单侧视觉（点状/色斑/线型闪光幻觉/视野缺损）" == strHeadacheProdrome)
                OCX.SetObjectInfo("RadioBox_16", "checked", "true");
            else
                OCX.SetObjectInfo("RadioBox_17", "checked", "true");
            if("双侧视觉（点状/色斑/线型闪光幻觉/视野缺损）" == strHeadacheProdrome)
                OCX.SetObjectInfo("RadioBox_19", "checked", "true");
            else
                OCX.SetObjectInfo("RadioBox_18", "checked", "true");
            if("感觉（针刺感/麻木）" == strHeadacheProdrome)
                OCX.SetObjectInfo("RadioBox_20", "checked", "true");
            else
                OCX.SetObjectInfo("RadioBox_21", "checked", "true");
            if("语言障碍" == strHeadacheProdrome)
                OCX.SetObjectInfo("RadioBox_23", "checked", "true");
            else
                OCX.SetObjectInfo("RadioBox_22", "checked", "true");
            if("运动障碍" == strHeadacheProdrome)
                OCX.SetObjectInfo("RadioBox_25", "checked", "true");
            else
                OCX.SetObjectInfo("RadioBox_24", "checked", "true");         
        }

        //set PreviousExam
        var strExamName = "";
        var strResult = "";
        var strDate = "";
        var lPreviousExamCount = obj.previousexam.length;
        for(var lPreviousExamIndex = 0; lPreviousExamIndex < lPreviousExamCount; ++lPreviousExamIndex)
        {
            strExamName = obj.previousexam[lPreviousExamIndex].ExamName;
            strResult = obj.previousexam[lPreviousExamIndex].Result;
            strDate = obj.previousexam[lPreviousExamIndex].Date;
            if(0 == lPreviousExamIndex)
            {
                OCX.SetObjectInfo("ComboBox_47", "text", strExamName);
                if("正常" == strResult)
                    OCX.SetObjectInfo("RadioBox_26", "checked", "true");
                //OCX.SetObjectInfo("DateTime_6", "text", strDate);
                OCX.SetObjectInfo("TextBox_110", "text", strDate.substring(0,4));
                if(strDate.substring(5,6) == '0')
                    OCX.SetObjectInfo("TextBox_109", "text", strDate.substring(6,7));
                else
                    OCX.SetObjectInfo("TextBox_109", "text", strDate.substring(5,7));
            }
            else if(1 == lPreviousExamIndex)
            {
                OCX.SetObjectInfo("ComboBox_48", "text", strExamName);
                if("正常" == strResult)
                    OCX.SetObjectInfo("RadioBox_27", "checked", "true");
                OCX.SetObjectInfo("TextBox_112", "text", strDate.substring(0,4));
                if(strDate.substring(5,6) == '0')
                    OCX.SetObjectInfo("TextBox_111", "text", strDate.substring(6,7));
                else
                    OCX.SetObjectInfo("TextBox_111", "text", strDate.substring(5,7));
            }
            else if(2 == lPreviousExamIndex)
            {
                OCX.SetObjectInfo("ComboBox_49", "text", strExamName);
                if("正常" == strResult)
                    OCX.SetObjectInfo("RadioBox_28", "checked", "true");
                OCX.SetObjectInfo("TextBox_114", "text", strDate.substring(0,4));
                if(strDate.substring(5,6) == '0')
                    OCX.SetObjectInfo("TextBox_113", "text", strDate.substring(6,7));
                else
                    OCX.SetObjectInfo("TextBox_113", "text", strDate.substring(5,7));
            }
//            else if(3 == lPreviousExamIndex)
//            {
//                OCX.SetObjectInfo("ComboBox_50", "text", strExamName);
//                if("正常" == strResult)
//                    OCX.SetObjectInfo("RadioBox_29", "checked", "true");
//                OCX.SetObjectInfo("DateTime_3", "text", strDate);
//            }
        }
        //debugger;
        //继续问诊时要用到的服用过的药物；
        //set PreviousDrug
        var strDrugCategory = "";
        var strDrugName = "";
        var strDayAmoutnPerM = "";
        var strMonthTotalAmount = "";
        var strDrugApplication = "";
        var lPreviousDrugCount = obj.previousdrug.length;//这里的药物信息没有止痛、预防分类
        var nRelievePain = 0;
        for(var lPreviousDrugIndex = 0; lPreviousDrugIndex < lPreviousDrugCount; ++lPreviousDrugIndex)
        {
            strDrugCategory = obj.previousdrug[lPreviousDrugIndex].DrugCategory;
            strDrugName = obj.previousdrug[lPreviousDrugIndex].DrugName;
            strDayAmoutnPerM = obj.previousdrug[lPreviousDrugIndex].DayAmoutnPerM;
            strMonthTotalAmount = obj.previousdrug[lPreviousDrugIndex].MonthTotalAmount;
            strDrugApplication = obj.previousdrug[lPreviousDrugIndex].DrugApplication;
            if("止痛" == strDrugApplication)
            {
           // debugger;
                ++nRelievePain;
                if(1 == nRelievePain)
                {
                    OCX.SetObjectInfo("ComboBox_46", "text", strDrugCategory);
                    //OCX.SetObjectInfo("TextBox_52", "text", strDrugName);
                    OCX.SetObjectInfo("TextBox_51", "text", strDayAmoutnPerM);
                    OCX.SetObjectInfo("TextBox_50", "text", strMonthTotalAmount);
                }
                else if(2 == nRelievePain)
                {
                    OCX.SetObjectInfo("ComboBox_45", "text", strDrugCategory);
                    //OCX.SetObjectInfo("TextBox_41", "text", strDrugName);
                    OCX.SetObjectInfo("TextBox_44", "text", strDayAmoutnPerM);
                    OCX.SetObjectInfo("TextBox_49", "text", strMonthTotalAmount);
                }
                else if(3 == nRelievePain)
                {
                    OCX.SetObjectInfo("ComboBox_44", "text", strDrugCategory);
                    //OCX.SetObjectInfo("TextBox_42", "text", strDrugName);
                    OCX.SetObjectInfo("TextBox_45", "text", strDayAmoutnPerM);
                    OCX.SetObjectInfo("TextBox_48", "text", strMonthTotalAmount);
                }
            }
            else if("预防" == strDrugApplication)
            {
                if("普萘罗尔" == strDrugName)
                    OCX.SetObjectInfo("CheckBox_36", "checked", "true");
                else if("美托洛尔" == strDrugName)
                    OCX.SetObjectInfo("CheckBox_37", "checked", "true");
                else if("氟桂利嗪" == strDrugName)
                    OCX.SetObjectInfo("CheckBox_38", "checked", "true");
                else if("丙戊酸" == strDrugName)
                    OCX.SetObjectInfo("CheckBox_40", "checked", "true");
                else if("托吡酯" == strDrugName)
                    OCX.SetObjectInfo("CheckBox_39", "checked", "true");
                else if("阿替洛" == strDrugName)
                    OCX.SetObjectInfo("CheckBox_53", "checked", "true");
                else if("地尔硫卓" == strDrugName)
                    OCX.SetObjectInfo("CheckBox_54", "checked", "true");
                else if("尼莫地平" == strDrugName)
                    OCX.SetObjectInfo("CheckBox_58", "checked", "true");
                else if("脑益嗪" == strDrugName)
                    OCX.SetObjectInfo("CheckBox_57", "checked", "true");
                else if("锂" == strDrugName)
                    OCX.SetObjectInfo("CheckBox_56", "checked", "true");
                else if("利培酮" == strDrugName)
                    OCX.SetObjectInfo("CheckBox_55", "checked", "true");
                else if("奥氮平" == strDrugName)
                    OCX.SetObjectInfo("CheckBox_59", "checked", "true");
                else if("喹硫平" == strDrugName)
                    OCX.SetObjectInfo("CheckBox_60", "checked", "true");
                else if("文拉法辛" == strDrugName)
                    OCX.SetObjectInfo("CheckBox_63", "checked", "true");
                else if("米氮平" == strDrugName)
                    OCX.SetObjectInfo("CheckBox_83", "checked", "true");
                else if("萘发唑酮" == strDrugName)
                    OCX.SetObjectInfo("CheckBox_82", "checked", "true");
                else if("安非他酮" == strDrugName)
                    OCX.SetObjectInfo("CheckBox_81", "checked", "true");
                else if("丁螺环酮" == strDrugName)
                    OCX.SetObjectInfo("CheckBox_86", "checked", "true");
                else if("中药" == strDrugName)
                    OCX.SetObjectInfo("CheckBox_85", "checked", "true");
                else if("其他" == strDrugName)
                    OCX.SetObjectInfo("CheckBox_84", "checked", "true");
            }
        }

        var strPreviousDiagnosis = obj.PreviousDiagnosis;
        OCX.SetObjectInfo("ComboBox_2", "text", strPreviousDiagnosis);

        //set life style
        var strTeaPerDay = obj.patlifestyle.TeaPerDay;
        OCX.SetObjectInfo("TextBox_55", "text", strTeaPerDay);
        var strCoffePerDay = obj.patlifestyle.CoffePerDay;
        OCX.SetObjectInfo("TextBox_54", "text", strCoffePerDay);

        var bIfAlwaysSmoke = obj.patlifestyle.SmokeState;
        if(bIfAlwaysSmoke)
            OCX.SetObjectInfo("RadioBox_3", "checked", "true");
        else
            OCX.SetObjectInfo("RadioBox_4", "checked", "true");

        var strSmokeYears = obj.patlifestyle.SmokeYear;
        OCX.SetObjectInfo("TextBox_62", "text", strSmokeYears);

        var bIfAlwaysDrink = obj.patlifestyle.DrinkState;
        if(bIfAlwaysDrink)
            OCX.SetObjectInfo("RadioBox_5", "checked", "true");
        else
            OCX.SetObjectInfo("RadioBox_6", "checked", "true");

        var strDrinkYears = obj.patlifestyle.DrinkYear;
        OCX.SetObjectInfo("TextBox_58", "text", strDrinkYears);

        var bIfAlwaysExercise = obj.patlifestyle.ExerciseOften;
        if(bIfAlwaysExercise)
            OCX.SetObjectInfo("RadioBox_1", "checked", "true");
        else
            OCX.SetObjectInfo("RadioBox_2", "checked", "true");

        //set Headache FamilyMember
        var strHeadacheFamilyMember = "";
        var lHeadacheFamilyMemberCount = obj.Hfamilymember.length;
        for(var lHeadacheFamilyMemberIndex = 0; lHeadacheFamilyMemberIndex < lHeadacheFamilyMemberCount; ++lHeadacheFamilyMemberIndex)
        {
            strHeadacheFamilyMember = obj.Hfamilymember[lHeadacheFamilyMemberIndex];
            if("父亲" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_80", "checked", "true");
            else if("母亲" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_75", "checked", "true");
            else if("兄弟" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_74", "checked", "true");
            else if("姐妹" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_70", "checked", "true");
            else if("儿子" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_79", "checked", "true");
            else if("女儿" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_76", "checked", "true");
            else if("祖父" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_73", "checked", "true");
            else if("祖母" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_71", "checked", "true");
            else if("外祖父" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_78", "checked", "true");
            else if("外祖母" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_77", "checked", "true");
            else if("其他" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_72", "checked", "true");
        }

        //set Other family disease
        var strOfamilydisease = "";
        var lOfamilydiseaseCount = obj.Ofamilydisease.length;
        for(var lOfamilydiseaseIndex = 0; lOfamilydiseaseIndex < lOfamilydiseaseCount; ++lOfamilydiseaseIndex)
        {
            strOfamilydisease = obj.Ofamilydisease[lOfamilydiseaseIndex];
            if("心脏疾病" == strOfamilydisease)
                OCX.SetObjectInfo("CheckBox_69", "checked", "true");
            else if("癫痫" == strOfamilydisease)
                OCX.SetObjectInfo("CheckBox_66", "checked", "true");
            else if("高血压" == strOfamilydisease)
                OCX.SetObjectInfo("CheckBox_65", "checked", "true");
            else if("卒中" == strOfamilydisease)
                OCX.SetObjectInfo("CheckBox_61", "checked", "true");
            else if("关节炎" == strOfamilydisease)
                OCX.SetObjectInfo("CheckBox_68", "checked", "true");
            else if("肿瘤" == strOfamilydisease)
                OCX.SetObjectInfo("CheckBox_67", "checked", "true");
            else if("焦虑" == strOfamilydisease)
                OCX.SetObjectInfo("CheckBox_64", "checked", "true");
            else if("其他" == strOfamilydisease)
                OCX.SetObjectInfo("CheckBox_62", "checked", "true");
        }

        //set Mitigating Factors
        var strMitigatingFactors = "";
        var lMitigatingFactorsCount = obj.mitigatingfactors.length;

        //set Chief Complaint
        strChiefComplaint += " " + "缓解因素:";

        for(var lMitigatingFactorsIndex = 0; lMitigatingFactorsIndex < lMitigatingFactorsCount; ++lMitigatingFactorsIndex)
        {
            strMitigatingFactors = obj.mitigatingfactors[lMitigatingFactorsIndex];

            //set Chief Complaint
            strChiefComplaint += " " + strMitigatingFactors;

            if("躺下" == strMitigatingFactors)
                OCX.SetObjectInfo("ComboBox_60", "text", "有");
            else if("黑暗/安静的房间" == strMitigatingFactors)
                OCX.SetObjectInfo("ComboBox_61", "text", "有");
            else if("按摩" == strMitigatingFactors)
                OCX.SetObjectInfo("ComboBox_62", "text", "有");
            else if("热敷" == strMitigatingFactors)
                OCX.SetObjectInfo("ComboBox_63", "text", "有");
            else if("冷敷" == strMitigatingFactors)
                OCX.SetObjectInfo("ComboBox_64", "text", "有");
            else if("快步走" == strMitigatingFactors)
                OCX.SetObjectInfo("ComboBox_56", "text", "有");
            else if("锻炼" == strMitigatingFactors)
                OCX.SetObjectInfo("ComboBox_57", "text", "有");
            else if("站立" == strMitigatingFactors)
                OCX.SetObjectInfo("ComboBox_58", "text", "有");
            else if("妊娠" == strMitigatingFactors)
                OCX.SetObjectInfo("ComboBox_59", "text", "有");
            else
                OCX.SetObjectInfo("TextBox_64", "text", strMitigatingFactors);
        }

        //set precipitating factors
        var strPrecipitatingFactorName = "";
        var strPrecipitatingFactorDetail = "";
        var lPrecipitatingFactorsCount = obj.precipitatingfactor.length;

        //set Chief Complaint
        strChiefComplaint += " " + "诱发因素:";

        for(var lPrecipitatingFactorsIndex = 0; lPrecipitatingFactorsIndex < lPrecipitatingFactorsCount; ++lPrecipitatingFactorsIndex)
        {
            strPrecipitatingFactorName = obj.precipitatingfactor[lPrecipitatingFactorsIndex].FName;
            strPrecipitatingFactorDetail = obj.precipitatingfactor[lPrecipitatingFactorsIndex].FDetail;

            //set Chief Complaint
            strChiefComplaint += " " + strPrecipitatingFactorName;
            strChiefComplaint += ":" + strPrecipitatingFactorDetail;

            if("睡眠" == strPrecipitatingFactorName)
                OCX.SetObjectInfo("ComboBox_69", "text", strPrecipitatingFactorDetail);
            else if("感觉刺激" == strPrecipitatingFactorName)
                OCX.SetObjectInfo("ComboBox_70", "text", strPrecipitatingFactorDetail);
            else if("紧张/情绪波动" == strPrecipitatingFactorName)
                OCX.SetObjectInfo("ComboBox_71", "text", "有");
            else if("食物" == strPrecipitatingFactorName)
                OCX.SetObjectInfo("ComboBox_72", "text", strPrecipitatingFactorDetail);
            else if("活动" == strPrecipitatingFactorName)
                OCX.SetObjectInfo("ComboBox_73", "text", strPrecipitatingFactorDetail);
            else if("气候" == strPrecipitatingFactorName)
                OCX.SetObjectInfo("ComboBox_65", "text", strPrecipitatingFactorDetail);
            else if("疲劳/放松" == strPrecipitatingFactorName)
                OCX.SetObjectInfo("ComboBox_66", "text", "有");
            else if("激素变化" == strPrecipitatingFactorName)
                OCX.SetObjectInfo("ComboBox_67", "text", strPrecipitatingFactorDetail);
            else if("体位" == strPrecipitatingFactorName)
                OCX.SetObjectInfo("ComboBox_68", "text", strPrecipitatingFactorDetail);
            else if("其他" == strPrecipitatingFactorName)
                OCX.SetObjectInfo("TextBox_65", "text", "strPrecipitatingFactorDetail");
        }

        //set chief complaint
        OCX.SetObjectInfo("TextBox_9", "text", strChiefComplaint);

        //
        var lMedicationadviceCount = obj.medicationadvice.length;
        for(var lMedicationadviceIndex = 0; lMedicationadviceIndex < lMedicationadviceCount; ++lMedicationadviceIndex)
        {
            var strDrugCategory = obj.medicationadvice[lMedicationadviceIndex].DrugCategory;
            var strDrugName = obj.medicationadvice[lMedicationadviceIndex].DrugName;
            var strDrugDose = obj.medicationadvice[lMedicationadviceIndex].DrugDose;
            var strDrugApplication = obj.medicationadvice[lMedicationadviceIndex].DrugApplication;
            if(0 == lMedicationadviceIndex)
            {
//                OCX.SetObjectInfo("TextBox_27", "text", strDrugCategory);
//                OCX.SetObjectInfo("TextBox_28", "text", strDrugName);
//                OCX.SetObjectInfo("TextBox_29", "text", strDrugDose);
//                OCX.SetObjectInfo("TextBox_30", "text", strDrugApplication);
            }
            else if(1 == lMedicationadviceIndex)
            {
//                OCX.SetObjectInfo("TextBox_31", "text", strDrugCategory);
//                OCX.SetObjectInfo("TextBox_32", "text", strDrugName);
//                OCX.SetObjectInfo("TextBox_33", "text", strDrugDose);
//                OCX.SetObjectInfo("TextBox_34", "text", strDrugApplication);
            }
            else if(2 == lMedicationadviceIndex)
            {
//                OCX.SetObjectInfo("TextBox_25", "text", strDrugCategory);
//                OCX.SetObjectInfo("TextBox_26", "text", strDrugName);
//                OCX.SetObjectInfo("TextBox_43", "text", strDrugDose);
//                OCX.SetObjectInfo("TextBox_46", "text", strDrugApplication);
            }
        }

        var strPrescriptionNote = obj.PrescriptionNote;
        OCX.SetObjectInfo("TextBox_47", "text", strPrescriptionNote);

        //PremonitorySymptom
        var listPremonitorSymptoms = obj.premonitorsymptom;
        for(var nIndexPremonitorSymptom = 0; nIndexPremonitorSymptom < listPremonitorSymptoms.length; ++nIndexPremonitorSymptom)
        {
            var strPremonitorSymptom = listPremonitorSymptoms[nIndexPremonitorSymptom];
            if("过度活跃" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_11", "checked", "true");
            else if("特别多话" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_12", "checked", "true");
            else if("沮丧" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_13", "checked", "true");
            else if("易激惹" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_14", "checked", "true");
            else if("感觉迟钝" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_15", "checked", "true");
            else if("思睡" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_19", "checked", "true");
            else if("坐立不安" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_20", "checked", "true");
            else if("注意力障碍" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_18", "checked", "true");
            else if("畏光" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_17", "checked", "true");
            else if("畏声" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_16", "checked", "true");
            else if("畏嗅" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_24", "checked", "true");
            else if("言语困难" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_25", "checked", "true");
            else if("打哈欠" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_23", "checked", "true");
            else if("颈部僵硬感" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_22", "checked", "true");
            else if("一直想吃东西" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_21", "checked", "true");
            else if("胃口变差" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_29", "checked", "true");
            else if("感觉冷" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_30", "checked", "true");
            else if("腹泻" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_28", "checked", "true");
            else if("便秘" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_27", "checked", "true");
            else if("特别口渴" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_26", "checked", "true");
            else if("多尿" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_34", "checked", "true");
            else if("感觉虚弱" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_35", "checked", "true");
            else if("头晕" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_33", "checked", "true");
            else if("水潴留、水肿" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_32", "checked", "true");
            else if("其他" == strPremonitorSymptom)
                OCX.SetObjectInfo("CheckBox_31", "checked", "true");
        }
        

        //disablityevaluation
        var strHeadacheDays = obj.disablityevaluation.HeadacheDays;
        OCX.SetObjectInfo("TextBox_57", "text", strHeadacheDays);

        var strOutOfWorkDays = obj.disablityevaluation.OutOfWorkDays;
        OCX.SetObjectInfo("TextBox_41", "text", strOutOfWorkDays);

        var strAffectWorkDays = obj.disablityevaluation.AffectWorkDays;
        OCX.SetObjectInfo("TextBox_42", "text", strAffectWorkDays);

        var strOutOfHouseWorkDays = obj.disablityevaluation.OutOfHouseWorkDays;
        OCX.SetObjectInfo("TextBox_52", "text", strOutOfHouseWorkDays);

        var strAffectHouseWorkDays = obj.disablityevaluation.AffectHouseWorkDays;
        OCX.SetObjectInfo("TextBox_53", "text", strAffectHouseWorkDays);

        var strMissActivityDays = obj.disablityevaluation.MissActivityDays;
        OCX.SetObjectInfo("TextBox_56", "text", strMissActivityDays);

        //SleepStatus
        var strSleepStatusTimePerDay = obj.sleepconditon.TimePerDay;
        OCX.SetObjectInfo("TextBox_59", "text", strSleepStatusTimePerDay);

        var strSleepStatusDifficultFallingAsleep = obj.sleepconditon.DifficultFallingAsleep;
        OCX.SetObjectInfo("ComboBox_25", "text", strSleepStatusDifficultFallingAsleep);

        var strSleepStatusDreaminess = obj.sleepconditon.Dreaminess;
        OCX.SetObjectInfo("ComboBox_27", "text", strSleepStatusDreaminess);

        var strSleepStatusFestlessSleep = obj.sleepconditon.FestlessSleep;
        OCX.SetObjectInfo("ComboBox_26", "text", strSleepStatusFestlessSleep);

        var strSleepStatusSleepyDayTime = obj.sleepconditon.SleepyDayTime;
        OCX.SetObjectInfo("ComboBox_28", "text", strSleepStatusSleepyDayTime);

        //PHQ
        var strPHQ1 = obj.phquestionaire.Q1;
        OCX.SetObjectInfo("ComboBox_8", "text", strPHQ1);

        var strPHQ2 = obj.phquestionaire.Q2;
        OCX.SetObjectInfo("ComboBox_9", "text", strPHQ2);

        var strPHQ3 = obj.phquestionaire.Q3;
        OCX.SetObjectInfo("ComboBox_10", "text", strPHQ3);

        var strPHQ4 = obj.phquestionaire.Q4;
        OCX.SetObjectInfo("ComboBox_11", "text", strPHQ4);

        var strPHQ5 = obj.phquestionaire.Q5;
        OCX.SetObjectInfo("ComboBox_12", "text", strPHQ5);

        var strPHQ6 = obj.phquestionaire.Q6;
        OCX.SetObjectInfo("ComboBox_13", "text", strPHQ6);

        var strPHQ7 = obj.phquestionaire.Q7;
        OCX.SetObjectInfo("ComboBox_14", "text", strPHQ7);

        var strPHQ8 = obj.phquestionaire.Q8;
        OCX.SetObjectInfo("ComboBox_15", "text", strPHQ8);

        var strPHQ9 = obj.phquestionaire.Q9;
        OCX.SetObjectInfo("ComboBox_16", "text", strPHQ9);

        //GADQ
        var strGADQ1 = obj.gdaquestionaire.Q1;
        OCX.SetObjectInfo("ComboBox_17", "text", strGADQ1);

        var strGADQ2 = obj.gdaquestionaire.Q2;
        OCX.SetObjectInfo("ComboBox_19", "text", strGADQ2);

        var strGADQ3 = obj.gdaquestionaire.Q3;
        OCX.SetObjectInfo("ComboBox_20", "text", strGADQ3);

        var strGADQ4 = obj.gdaquestionaire.Q4;
        OCX.SetObjectInfo("ComboBox_21", "text", strGADQ4);

        var strGADQ5 = obj.gdaquestionaire.Q5;
        OCX.SetObjectInfo("ComboBox_22", "text", strGADQ5);

        var strGADQ6 = obj.gdaquestionaire.Q6;
        OCX.SetObjectInfo("ComboBox_23", "text", strGADQ6);

        var strGADQ7 = obj.gdaquestionaire.Q7;
        OCX.SetObjectInfo("ComboBox_24", "text", strGADQ7);

        //set diagnosis
        var strDiagnosisResult1 = obj.DiagnosisResult1;
        SetDiagnosisIntoOCX(OCX, "ComboBox_31", "ComboBox_32", strDiagnosisResult1);
        var strDiagnosisResult2 = obj.DiagnosisResult2;
        SetDiagnosisIntoOCX(OCX, "ComboBox_33", "ComboBox_34", strDiagnosisResult2);
        var strDiagnosisResult3 = obj.DiagnosisResult3;
        SetDiagnosisIntoOCX(OCX, "ComboBox_36", "ComboBox_35", strDiagnosisResult3);

        //set doctor advice
        var listMedicationAdvice = obj.medicationadvice;
        var diagnosis=OCX.GetObjectInfo("ComboBox_31", "text");
        switch (diagnosis)
        {
            case "紧张型头痛":
            {
                 for(var nIndex = 0; nIndex < listMedicationAdvice.length; ++nIndex)   
                 {
                    var strDrugName = listMedicationAdvice[nIndex].DrugName;
                    var strDrugDose = listMedicationAdvice[nIndex].DrugDose;
                    var strDrugDoseUnit = listMedicationAdvice[nIndex].DrugDoseUnit;
                    var strDrugApplication = listMedicationAdvice[nIndex].DrugApplication;
                    if(0 == nIndex)
                    {
                        OCX.SetObjectInfo("TextBox_60", "text", strDrugName);
                        OCX.SetObjectInfo("TextBox_95", "text", strDrugDose);
                        OCX.SetObjectInfo("ComboBox_3", "text", strDrugDoseUnit);
                        OCX.SetObjectInfo("ComboBox_4", "text", strDrugApplication);
                    }
                    else if(1 == nIndex)
                    {
                        OCX.SetObjectInfo("TextBox_4", "text", strDrugName);
                        OCX.SetObjectInfo("TextBox_94", "text", strDrugDose);
                        OCX.SetObjectInfo("ComboBox_6", "text", strDrugDoseUnit);
                        OCX.SetObjectInfo("ComboBox_5", "text", strDrugApplication);
                    }
                    else if(2 == nIndex)
                    {
                        OCX.SetObjectInfo("TextBox_61", "text", strDrugName);
                        OCX.SetObjectInfo("TextBox_93", "text", strDrugDose);
                        OCX.SetObjectInfo("ComboBox_30", "text", strDrugDoseUnit);
                        OCX.SetObjectInfo("ComboBox_29", "text", strDrugApplication);
                    }
                 }    
            }
            break;
            case "偏头痛":
            {
                for(var nIndex = 0; nIndex < listMedicationAdvice.length; ++nIndex)   
                 {
                    var strDrugName = listMedicationAdvice[nIndex].DrugName;
                    var strDrugDose = listMedicationAdvice[nIndex].DrugDose;
                    var strDrugDoseUnit = listMedicationAdvice[nIndex].DrugDoseUnit;
                    var strDrugApplication = listMedicationAdvice[nIndex].DrugApplication;
                    if(0 == nIndex)
                    {
                        OCX.SetObjectInfo("TextBox_70", "text", strDrugName);
                        OCX.SetObjectInfo("TextBox_101", "text", strDrugDose);
                        OCX.SetObjectInfo("ComboBox_77", "text", strDrugDoseUnit);
                        OCX.SetObjectInfo("ComboBox_74", "text", strDrugApplication);
                    }
                    else if(1 == nIndex)
                    {
                        OCX.SetObjectInfo("TextBox_69", "text", strDrugName);
                        OCX.SetObjectInfo("TextBox_100", "text", strDrugDose);
                        OCX.SetObjectInfo("ComboBox_76", "text", strDrugDoseUnit);
                        OCX.SetObjectInfo("ComboBox_55", "text", strDrugApplication);
                    }
                    else if(2 == nIndex)
                    {
                        OCX.SetObjectInfo("TextBox_68", "text", strDrugName);
                        OCX.SetObjectInfo("TextBox_99", "text", strDrugDose);
                        OCX.SetObjectInfo("ComboBox_75", "text", strDrugDoseUnit);
                        OCX.SetObjectInfo("ComboBox_54", "text", strDrugApplication);
                    }
                 }    
            }
            break;
            case "丛集性头痛和其他原发性三叉神经痛":
            {
                for(var nIndex = 0; nIndex < listMedicationAdvice.length; ++nIndex)   
                 {
                    var strDrugName = listMedicationAdvice[nIndex].DrugName;
                    var strDrugDose = listMedicationAdvice[nIndex].DrugDose;
                    var strDrugDoseUnit = listMedicationAdvice[nIndex].DrugDoseUnit;
                    var strDrugApplication = listMedicationAdvice[nIndex].DrugApplication;
                    if(0 == nIndex)
                    {
                        OCX.SetObjectInfo("TextBox_73", "text", strDrugName);
                        OCX.SetObjectInfo("TextBox_86", "text", strDrugDose);
                        OCX.SetObjectInfo("ComboBox_78", "text", strDrugDoseUnit);
                        OCX.SetObjectInfo("ComboBox_83", "text", strDrugApplication);
                    }
                    else if(1 == nIndex)
                    {
                        OCX.SetObjectInfo("TextBox_72", "text", strDrugName);
                        OCX.SetObjectInfo("TextBox_85", "text", strDrugDose);
                        OCX.SetObjectInfo("ComboBox_79", "text", strDrugDoseUnit);
                        OCX.SetObjectInfo("ComboBox_82", "text", strDrugApplication);
                    }
                    else if(2 == nIndex)
                    {
                        OCX.SetObjectInfo("TextBox_71", "text", strDrugName);
                        OCX.SetObjectInfo("TextBox_84", "text", strDrugDose);
                        OCX.SetObjectInfo("ComboBox_80", "text", strDrugDoseUnit);
                        OCX.SetObjectInfo("ComboBox_81", "text", strDrugApplication);
                    }
                 }
            }
            break;
            case "颅神经痛和中枢源性面痛":
            {
                for(var nIndex = 0; nIndex < listMedicationAdvice.length; ++nIndex)   
                 {
                    var strDrugName = listMedicationAdvice[nIndex].DrugName;
                    var strDrugDose = listMedicationAdvice[nIndex].DrugDose;
                    var strDrugDoseUnit = listMedicationAdvice[nIndex].DrugDoseUnit;
                    var strDrugApplication = listMedicationAdvice[nIndex].DrugApplication;
                    if(0 == nIndex)
                    {
                        OCX.SetObjectInfo("TextBox_67", "text", strDrugName);
                        OCX.SetObjectInfo("TextBox_104", "text", strDrugDose);
                        OCX.SetObjectInfo("ComboBox_51", "text", strDrugDoseUnit);
                        OCX.SetObjectInfo("ComboBox_50", "text", strDrugApplication);
                    }
                    else if(1 == nIndex)
                    {
                        OCX.SetObjectInfo("TextBox_66", "text", strDrugName);
                        OCX.SetObjectInfo("TextBox_103", "text", strDrugDose);
                        OCX.SetObjectInfo("ComboBox_52", "text", strDrugDoseUnit);
                        OCX.SetObjectInfo("ComboBox_43", "text", strDrugApplication);
                    }
                    else if(2 == nIndex)
                    {
                        OCX.SetObjectInfo("TextBox_63", "text", strDrugName);
                        OCX.SetObjectInfo("TextBox_102", "text", strDrugDose);
                        OCX.SetObjectInfo("ComboBox_53", "text", strDrugDoseUnit);
                        OCX.SetObjectInfo("ComboBox_42", "text", strDrugApplication);
                    }
                 }
            }
            break;
            case "慢性每日头痛":
            {
                for(var nIndex = 0; nIndex < listMedicationAdvice.length; ++nIndex)   
                 {
                    var strDrugName = listMedicationAdvice[nIndex].DrugName;
                    var strDrugDose = listMedicationAdvice[nIndex].DrugDose;
                    var strDrugDoseUnit = listMedicationAdvice[nIndex].DrugDoseUnit;
                    var strDrugApplication = listMedicationAdvice[nIndex].DrugApplication;
                    if(0 == nIndex)
                    {
                        OCX.SetObjectInfo("TextBox_76", "text", strDrugName);
                        OCX.SetObjectInfo("TextBox_81", "text", strDrugDose);
                        OCX.SetObjectInfo("ComboBox_84", "text", strDrugDoseUnit);
                        OCX.SetObjectInfo("ComboBox_89", "text", strDrugApplication);
                    }
                    else if(1 == nIndex)
                    {
                        OCX.SetObjectInfo("TextBox_75", "text", strDrugName);
                        OCX.SetObjectInfo("TextBox_82", "text", strDrugDose);
                        OCX.SetObjectInfo("ComboBox_85", "text", strDrugDoseUnit);
                        OCX.SetObjectInfo("ComboBox_88", "text", strDrugApplication);
                    }
                    else if(2 == nIndex)
                    {
                        OCX.SetObjectInfo("TextBox_74", "text", strDrugName);
                        OCX.SetObjectInfo("TextBox_83", "text", strDrugDose);
                        OCX.SetObjectInfo("ComboBox_86", "text", strDrugDoseUnit);
                        OCX.SetObjectInfo("ComboBox_87", "text", strDrugApplication);
                    }
                 }
            }
            break;
            default:
            {
                for(var nIndex = 0; nIndex < listMedicationAdvice.length; ++nIndex)   
                 {
                    var strDrugName = listMedicationAdvice[nIndex].DrugName;
                    var strDrugDose = listMedicationAdvice[nIndex].DrugDose;
                    var strDrugDoseUnit = listMedicationAdvice[nIndex].DrugDoseUnit;
                    var strDrugApplication = listMedicationAdvice[nIndex].DrugApplication;
                    if(0 == nIndex)
                    {
                        OCX.SetObjectInfo("TextBox_79", "text", strDrugName);
                        OCX.SetObjectInfo("TextBox_107", "text", strDrugDose);
                        OCX.SetObjectInfo("ComboBox_90", "text", strDrugDoseUnit);
                        OCX.SetObjectInfo("ComboBox_95", "text", strDrugApplication);
                    }
                    else if(1 == nIndex)
                    {
                        OCX.SetObjectInfo("TextBox_78", "text", strDrugName);
                        OCX.SetObjectInfo("TextBox_106", "text", strDrugDose);
                        OCX.SetObjectInfo("ComboBox_91", "text", strDrugDoseUnit);
                        OCX.SetObjectInfo("ComboBox_94", "text", strDrugApplication);
                    }
                    else if(2 == nIndex)
                    {
                        OCX.SetObjectInfo("TextBox_77", "text", strDrugName);
                        OCX.SetObjectInfo("TextBox_105", "text", strDrugDose);
                        OCX.SetObjectInfo("ComboBox_92", "text", strDrugDoseUnit);
                        OCX.SetObjectInfo("ComboBox_93", "text", strDrugApplication);
                    }
                 }
            }
            break;
        }
    }
     function SetHeadachePlace(obj)
    { 
      var lheadacheplaceCount = obj.headacheplace.length;
      //debugger;
       if(lheadacheplaceCount>0){
         var place=obj.headacheplace[lheadacheplaceCount-1].charAt(0);
                switch (place)
                {
                case "双":
                   document.getElementById("bi").checked=true;
                  break;
                case "左":
                  document.getElementById("unileft").checked=true;
                  break;
                case "右":
                  document.getElementById("uniright").checked=true;
                  break;
                  }
       }
      for(var i=0;i<lheadacheplaceCount;i++)
      {
        if(obj.headacheplace[i].indexOf("耳部")>=0)
        MapFunction("#p1");
        if(obj.headacheplace[i].indexOf("枕部")>=0)
        MapFunction("#p2");
        if(obj.headacheplace[i].indexOf("颈部")>=0)
        MapFunction("#p3");
        if(obj.headacheplace[i].indexOf("前额")>=0)
        MapFunction("#p4");
        if(obj.headacheplace[i].indexOf("顶部")>=0)
        MapFunction("#p5");
        if(obj.headacheplace[i].indexOf("颌部")>=0)
        MapFunction("#p6");
        if(obj.headacheplace[i].indexOf("眶部")>=0)
        MapFunction("#p7");
        if(obj.headacheplace[i].indexOf("颞部")>=0)
        MapFunction("#p8");
         if(obj.headacheplace[i].indexOf("脸部")>=0)
        MapFunction("#p9");
      }

    }
   

    function ChangeDataFromOCXIntoJSObject(OCX)
    {
        //get SecondaryHeadacheSymptoms
                var strSecondaryHeadacheSymptom1 = "";
                var strSecondaryHeadacheSymptom2 = "";
                var strSecondaryHeadacheSymptom3 = "";
                var strSecondaryHeadacheSymptom4 = "";
                var strSecondaryHeadacheSymptom5 = "";
                var strSecondaryHeadacheSymptom6 = "";
                var strSecondaryHeadacheSymptom7 = "";
                var strSecondaryHeadacheSymptom8 = "";
                var strSecondaryHeadacheSymptom9 = "";
                var strSecondaryHeadacheSymptom10 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_1", "checked"))
                    strSecondaryHeadacheSymptom1 = "突然发生的头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_2", "checked"))
                    strSecondaryHeadacheSymptom2 = "逐渐加重的头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_3", "checked"))
                    strSecondaryHeadacheSymptom3 = "伴有系统性病变征象（发热、颈强直、皮疹）的头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_4", "checked"))
                    strSecondaryHeadacheSymptom4 = "神经系统局灶症状和体征（除典型的视觉、感觉先兆之外）";
                if("true" == OCX.GetObjectInfo("CheckBox_5", "checked"))
                    strSecondaryHeadacheSymptom5 = "伴有认知障碍的头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_6", "checked"))
                   strSecondaryHeadacheSymptom6 = "视乳头水肿";
                if("true" == OCX.GetObjectInfo("CheckBox_7", "checked"))
                    strSecondaryHeadacheSymptom7 = "由咳嗽、用力动作诱发的头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_8", "checked"))
                    strSecondaryHeadacheSymptom8 = "妊娠期或产后头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_9", "checked"))
                    strSecondaryHeadacheSymptom9 = "癌症患者或AIDS患者出现新发头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_10", "checked"))
                    strSecondaryHeadacheSymptom10 = "50岁后的新发头痛";
                 
                
                //get the PrimaryHeadacheOverView information
                var strOnsetDate = "";

                //
                var strOnsetDateYear = OCX.GetObjectInfo("TextBox_80", "text");
                var strOnsetDateMonth = OCX.GetObjectInfo("TextBox_108", "text");
                var nOnsetDateYear = parseInt(strOnsetDateYear, 10);
                var nOnsetDateMonth = parseInt(strOnsetDateMonth, 10);
                if(isNaN(nOnsetDateYear) || isNaN(nOnsetDateMonth) || nOnsetDateYear<1753 
                || nOnsetDateYear>3000 || nOnsetDateMonth<1 || nOnsetDateMonth>12)
                    strOnsetDate = "1753/01/01///";
                else
                {
                    strOnsetDateYear=nOnsetDateYear.toString();
                    strOnsetDateMonth=nOnsetDateMonth.toString();
                    if(strOnsetDateMonth.length == 1)
                        strOnsetDateMonth = '0'+strOnsetDateMonth;
                    strOnsetDate = strOnsetDateYear+"/"+strOnsetDateMonth+"/01///";
                }
                if ("/////" == strOnsetDate) 
                {
                    strOnsetDate = "1753/01/01///";
                }
                var strOnsetDate = strOnsetDate.slice(0, 10).replace("/", "-").replace("/", "-") + " 00:00:00";

                var strFirstOnsetContinue = OCX.GetObjectInfo("ComboBox_37", "text");
                //var strOnsetFixedDay = OCX.GetObjectInfo("ComboBox_42", "text");
                //var strOnsetFixedYear = OCX.GetObjectInfo("ComboBox_24", "text");
                var strIfFixed = OCX.GetObjectInfo("ComboBox_1", "text");
                var strHeadacheDegree = OCX.GetObjectInfo("ComboBox_41", "text");
                var strHeadacheType = OCX.GetObjectInfo("ComboBox_40", "text");
                var strDailyAggravation = OCX.GetObjectInfo("ComboBox_38", "text");
                var strHeadcheTime = OCX.GetObjectInfo("TextBox_40", "text");
                var strHeacheTimeUnit = OCX.GetObjectInfo("ComboBox_39", "text");
                var strOnsetAmount = "";
                if("true" == OCX.GetObjectInfo("RadioBox_15", "checked"))
                    strOnsetAmount = "类似发作<5次";
                else if("true" == OCX.GetObjectInfo("RadioBox_14", "checked"))
                    strOnsetAmount = "类似发作6-9次";
                else if("true" == OCX.GetObjectInfo("RadioBox_12", "checked"))
                    strOnsetAmount = "类似发作超过10次";
                else if("true" == OCX.GetObjectInfo("RadioBox_13", "checked"))
                    strOnsetAmount = "持续头痛";
                //var strFrequencyPerMonth = OCX.GetObjectInfo("ComboBox_7", "text");
                var strFrequencyPerMonth = "";
                if("true" == OCX.GetObjectInfo("RadioBox_7", "checked"))
                    strFrequencyPerMonth = "<1";
                else if("true" == OCX.GetObjectInfo("RadioBox_8", "checked"))
                    strFrequencyPerMonth = "1-15";
                else if("true" == OCX.GetObjectInfo("RadioBox_9", "checked"))
                    strFrequencyPerMonth = ">15";
                //var strFrequencyPerDay = OCX.GetObjectInfo("ComboBox_18", "text");

                //get headache place
                var strHeadachePlace = "";
                var strSpecificPlace1 = "";
                var strSpecificPlace2 = "";
                var strSpecificPlace3 = "";
                var strSpecificPlace4 = "";
                var strSpecificPlace5 = "";
                var strSpecificPlace6 = "";
                var strSpecificPlace7 = "";
                var strSpecificPlace8 = "";
                var strSpecificPlace9 = "";
                var strSpecificPlace10 = "";
                var strSpecificPlace11 = "";
                var strSpecificPlace12 = "";
                var strSpecificPlace13 = "";

                var value=GetHeadachePlace();
//                if("true" == OCX.GetObjectInfo("RadioBox_4", "checked"))
//                    strHeadachePlace = "左侧为主";
//                else if("true" == OCX.GetObjectInfo("RadioBox_9", "checked"))
//                    strHeadachePlace = "右侧为主";
//                else if("true" == OCX.GetObjectInfo("RadioBox_10", "checked"))
//                    strHeadachePlace = "双侧";
                    if(document.getElementById("bi").checked)
                     strHeadachePlace = "双侧";
                    if(document.getElementById("unileft").checked)
                    strHeadachePlace ="左侧为主";
                    if(document.getElementById("uniright").checked)
                     strHeadachePlace = "右侧为主";
                if(value[7])
                    strSpecificPlace1 = "颞部";
                if(value[1])
                    strSpecificPlace2 = "枕部";
                if(value[4])
                    strSpecificPlace3 = "顶部";
                if(value[6])
                    strSpecificPlace4 = "眶部";
                if(value[2])
                    strSpecificPlace5 = "颈部";
                if(value[5])
                    strSpecificPlace6 = "颌部";
                if(value[8])
                    strSpecificPlace8 = "脸部";
               if(value[0])
                    strSpecificPlace9 = "耳部"; 
                if(value[3])
                    strSpecificPlace11 = "前额";
                if("true" == OCX.GetObjectInfo("CheckBox_QuanHeadache", "checked"))
                    strSpecificPlace12 = "全头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_OtherHeadache", "checked"))
                    strSpecificPlace13 = "其他";


                //Get HeadacheFamilyMember
                var strFuQin = "";
                var strMuQin = "";
                var strXiongDi = "";
                var strJieMei = "";
                var strErZi = "";
                var strNvEr = "";
                var strZuFu = "";
                var strZiMu = "";
                var strWaiZuFu = "";
                var strWaiZuMu = "";
                var strHFamilyMemberQiTa = "";
                if("true" == OCX.GetObjectInfo("CheckBox_80", "checked"))
                    strFuQin = "父亲";
                if("true" == OCX.GetObjectInfo("CheckBox_75", "checked"))
                    strMuQin = "母亲";
                if("true" == OCX.GetObjectInfo("CheckBox_74", "checked"))
                    strXiongDi = "兄弟";
                if("true" == OCX.GetObjectInfo("CheckBox_70", "checked"))
                    strJieMei = "姐妹";
                if("true" == OCX.GetObjectInfo("CheckBox_79", "checked"))
                    strErZi = "儿子";
                if("true" == OCX.GetObjectInfo("CheckBox_76", "checked"))
                    strNvEr = "女儿";
                if("true" == OCX.GetObjectInfo("CheckBox_73", "checked"))
                    strZuFu = "祖父";
                if("true" == OCX.GetObjectInfo("CheckBox_71", "checked"))
                    strZiMu = "祖母";
                if("true" == OCX.GetObjectInfo("CheckBox_78", "checked"))
                    strWaiZuFu = "外祖父";
                if("true" == OCX.GetObjectInfo("CheckBox_77", "checked"))
                    strWaiZuMu = "外祖母";
                if("true" == OCX.GetObjectInfo("CheckBox_72", "checked"))
                    strHFamilyMemberQiTa = "其他";
                
                //get OtherFamilyDisease
                var strXinZangJiBin = "";
                var strDianXian = "";
                var strGaoXueYa = "";
                var strZuZhong = "";
                var strGuanJieYan = "";
                var strZhongLiu = "";
                var strJiaoLv = "";
                var strOFamilyDiseaseQiTa = "";
                if("true" == OCX.GetObjectInfo("CheckBox_69", "checked"))
                    strXinZangJiBin = "心脏疾病";
                if("true" == OCX.GetObjectInfo("CheckBox_66", "checked"))
                    strDianXian = "癫痫";
                if("true" == OCX.GetObjectInfo("CheckBox_65", "checked"))
                    strGaoXueYa = "高血压";
                if("true" == OCX.GetObjectInfo("CheckBox_61", "checked"))
                    strZuZhong = "卒中";
                if("true" == OCX.GetObjectInfo("CheckBox_68", "checked"))
                    strGuanJieYan = "关节炎";
                if("true" == OCX.GetObjectInfo("CheckBox_67", "checked"))
                    strZhongLiu = "肿瘤";
                if("true" == OCX.GetObjectInfo("CheckBox_64", "checked"))
                    strJiaoLv = "焦虑";
                if("true" == OCX.GetObjectInfo("CheckBox_62", "checked"))
                    strOFamilyDiseaseQiTa = "其他";

                //get lifestyle
                var bIfAlwaysSmoke = OCX.GetObjectInfo("RadioBox_3", "checked");
                var strSmokeYears = OCX.GetObjectInfo("TextBox_62", "text");
                var bIfAlwaysDrink = OCX.GetObjectInfo("RadioBox_5", "checked");
                var strDrinkYears = OCX.GetObjectInfo("TextBox_58", "text");
                var bIfAlwaysExercise = OCX.GetObjectInfo("RadioBox_1", "checked");
                var strTeaPerDay = OCX.GetObjectInfo("TextBox_55", "text");
                var strCoffePerDay = OCX.GetObjectInfo("TextBox_54", "text");

                //get PreviousDrug
                var strDrugCategory1 = OCX.GetObjectInfo("ComboBox_46", "text");
                var strDrugApplication1 = "止痛";
                var strDayAmoutnPerM1 = OCX.GetObjectInfo("TextBox_51", "text");
                var strMonthTotalAmount1 = OCX.GetObjectInfo("TextBox_50", "text");

                var strDrugCategory2 = OCX.GetObjectInfo("ComboBox_45", "text");
                var strDrugApplication2 = "止痛";
                var strDayAmoutnPerM2 = OCX.GetObjectInfo("TextBox_44", "text");
                var strMonthTotalAmount2 = OCX.GetObjectInfo("TextBox_49", "text");

                var strDrugCategory3 = OCX.GetObjectInfo("ComboBox_44", "text");
                var strDrugApplication3 = "止痛";
                var strDayAmoutnPerM3 = OCX.GetObjectInfo("TextBox_45", "text");
                var strMonthTotalAmount3 = OCX.GetObjectInfo("TextBox_48", "text");

                var strPreviousDiagnosis = OCX.GetObjectInfo("ComboBox_2", "text");

                var strDrugCategoryPNLE1 = "";
                var strDrugNamePNLE1 = "";
                var strDrugApplicationPNLE1 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_36", "checked"))
                {
                    strDrugCategoryPNLE1 = "β阻滞剂";
                    strDrugNamePNLE1 = "普萘罗尔";
                    strDrugApplicationPNLE1 = "预防";
                }

                var strDrugCategoryPNLE2 = "";
                var strDrugNamePNLE2 = "";
                var strDrugApplicationPNLE2 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_37", "checked"))
                {
                    strDrugCategoryPNLE2 = "β阻滞剂";
                    strDrugNamePNLE2 = "美托洛尔";
                    strDrugApplicationPNLE2 = "预防";
                }

                var strDrugCategoryPNLE3 = "";
                var strDrugNamePNLE3 = "";
                var strDrugApplicationPNLE3 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_38", "checked"))
                {
                    strDrugCategoryPNLE3 = "钙离子拮抗剂";
                    strDrugNamePNLE3 = "氟桂利嗪";
                    strDrugApplicationPNLE3 = "预防";
                }

                var strDrugCategoryPNLE4 = "";
                var strDrugNamePNLE4 = "";
                var strDrugApplicationPNLE4 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_40", "checked"))
                {
                    strDrugCategoryPNLE4 = "抗癫痫药";
                    strDrugNamePNLE4 = "丙戊酸";
                    strDrugApplicationPNLE4 = "预防";
                }

                var strDrugCategoryPNLE5 = "";
                var strDrugNamePNLE5 = "";
                var strDrugApplicationPNLE5 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_39", "checked"))
                {
                    strDrugCategoryPNLE5 = "抗癫痫药";
                    strDrugNamePNLE5 = "托吡酯";
                    strDrugApplicationPNLE5 = "预防";
                }

                var strDrugCategoryPNLE6 = "";
                var strDrugNamePNLE6 = "";
                var strDrugApplicationPNLE6 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_53", "checked"))
                {
                    strDrugCategoryPNLE6 = "其他";
                    strDrugNamePNLE6 = "阿替洛";
                    strDrugApplicationPNLE6 = "预防";
                }

                var strDrugCategoryPNLE7 = "";
                var strDrugNamePNLE7 = "";
                var strDrugApplicationPNLE7 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_54", "checked"))
                {
                    strDrugCategoryPNLE7 = "其他";
                    strDrugNamePNLE7 = "地尔硫卓";
                    strDrugApplicationPNLE7 = "预防";
                }

                var strDrugCategoryPNLE8 = "";
                var strDrugNamePNLE8 = "";
                var strDrugApplicationPNLE8 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_58", "checked"))
                {
                    strDrugCategoryPNLE8 = "其他";
                    strDrugNamePNLE8 = "尼莫地平";
                    strDrugApplicationPNLE8 = "预防";
                }

                var strDrugCategoryPNLE9 = "";
                var strDrugNamePNLE9 = "";
                var strDrugApplicationPNLE9 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_57", "checked"))
                {
                    strDrugCategoryPNLE9 = "其他";
                    strDrugNamePNLE9 = "脑益嗪";
                    strDrugApplicationPNLE9 = "预防";
                }

                var strDrugCategoryPNLE10 = "";
                var strDrugNamePNLE10 = "";
                var strDrugApplicationPNLE10 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_56", "checked"))
                {
                    strDrugCategoryPNLE10 = "其他";
                    strDrugNamePNLE10 = "锂";
                    strDrugApplicationPNLE10 = "预防";
                }

                var strDrugCategoryPNLE11 = "";
                var strDrugNamePNLE11 = "";
                var strDrugApplicationPNLE11 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_55", "checked"))
                {
                    strDrugCategoryPNLE11 = "其他";
                    strDrugNamePNLE11 = "利培酮";
                    strDrugApplicationPNLE11 = "预防";
                }

                var strDrugCategoryPNLE12 = "";
                var strDrugNamePNLE12 = "";
                var strDrugApplicationPNLE12 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_59", "checked"))
                {
                    strDrugCategoryPNLE12 = "其他";
                    strDrugNamePNLE12 = "奥氮平";
                    strDrugApplicationPNLE12 = "预防";
                }

                var strDrugCategoryPNLE13 = "";
                var strDrugNamePNLE13 = "";
                var strDrugApplicationPNLE13 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_60", "checked"))
                {
                    strDrugCategoryPNLE13 = "其他";
                    strDrugNamePNLE13 = "喹硫平";
                    strDrugApplicationPNLE13 = "预防";
                }

                var strDrugCategoryPNLE14 = "";
                var strDrugNamePNLE14 = "";
                var strDrugApplicationPNLE14 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_63", "checked"))
                {
                    strDrugCategoryPNLE14 = "其他";
                    strDrugNamePNLE14 = "文拉法辛";
                    strDrugApplicationPNLE14 = "预防";
                }

                var strDrugCategoryPNLE15 = "";
                var strDrugNamePNLE15 = "";
                var strDrugApplicationPNLE15 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_83", "checked"))
                {
                    strDrugCategoryPNLE15 = "其他";
                    strDrugNamePNLE15 = "米氮平";
                    strDrugApplicationPNLE15 = "预防";
                }

                var strDrugCategoryPNLE16 = "";
                var strDrugNamePNLE16 = "";
                var strDrugApplicationPNLE16 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_82", "checked"))
                {
                    strDrugCategoryPNLE16 = "其他";
                    strDrugNamePNLE16 = "萘发唑酮";
                    strDrugApplicationPNLE16 = "预防";
                }

                var strDrugCategoryPNLE17 = "";
                var strDrugNamePNLE17 = "";
                var strDrugApplicationPNLE17 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_81", "checked"))
                {
                    strDrugCategoryPNLE17 = "其他";
                    strDrugNamePNLE17 = "安非他酮";
                    strDrugApplicationPNLE17 = "预防";
                }

                var strDrugCategoryPNLE18 = "";
                var strDrugNamePNLE18 = "";
                var strDrugApplicationPNLE18 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_86", "checked"))
                {
                    strDrugCategoryPNLE18 = "其他";
                    strDrugNamePNLE18 = "丁螺环酮";
                    strDrugApplicationPNLE18 = "预防";
                }

                var strDrugCategoryPNLE19 = "";
                var strDrugNamePNLE19 = "";
                var strDrugApplicationPNLE19 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_85", "checked"))
                {
                    strDrugCategoryPNLE19 = "其他";
                    strDrugNamePNLE19 = "中药";
                    strDrugApplicationPNLE19 = "预防";
                }

                var strDrugCategoryPNLE20 = "";
                var strDrugNamePNLE20 = "";
                var strDrugApplicationPNLE20 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_84", "checked"))
                {
                    strDrugCategoryPNLE20 = "其他";
                    strDrugNamePNLE20 = "其他";
                    strDrugApplicationPNLE20 = "预防";
                }

                //get PreviousExam
                var strExamName1 = OCX.GetObjectInfo("ComboBox_47", "text");
                var strExamResult1 = "异常";
                if("true" == OCX.GetObjectInfo("RadioBox_26", "checked"))
                    strExamResult1 = "正常";
                var strExamDate1 = "";//OCX.GetObjectInfo("DateTime_6", "text");
                //
                var strExamDate1Year = OCX.GetObjectInfo("TextBox_110", "text");
                var strExamDate1Month = OCX.GetObjectInfo("TextBox_109", "text");
                var nExamDate1Year = parseInt(strExamDate1Year, 10);
                var nExamDate1Month = parseInt(strExamDate1Month, 10);
                if(isNaN(nExamDate1Year) || isNaN(nExamDate1Month) || nExamDate1Year<1753 
                || nExamDate1Year>3000 || nExamDate1Month<1 || nExamDate1Month>12)
                    strExamDate1 = "1753/01/01///";
                else
                {
                    strExamDate1Year=nExamDate1Year.toString();
                    strExamDate1Month=nExamDate1Month.toString();
                    if(strExamDate1Month.length == 1)
                        strExamDate1Month = '0' + strExamDate1Month;
                    strExamDate1 = strExamDate1Year+"/"+strExamDate1Month+"/01///";
                }
                if ("/////" == strExamDate1) 
                {
                    strExamDate1 = "1753/01/01///";
                }
                var strExamDate1 = strExamDate1.slice(0, 10).replace("/", "-").replace("/", "-") + " 00:00:00";

                var strExamName2 = OCX.GetObjectInfo("ComboBox_48", "text");
                var strExamResult2 = "异常";
                if("true" == OCX.GetObjectInfo("RadioBox_27", "checked"))
                    strExamResult2 = "正常";
                var strExamDate2 = "";//OCX.GetObjectInfo("DateTime_5", "text");
                //
                var strExamDate2Year = OCX.GetObjectInfo("TextBox_112", "text");
                var strExamDate2Month = OCX.GetObjectInfo("TextBox_111", "text");
                var nExamDate2Year = parseInt(strExamDate2Year, 10);
                var nExamDate2Month = parseInt(strExamDate2Month, 10);
                if(isNaN(nExamDate2Year) || isNaN(nExamDate2Month) || nExamDate2Year<1753 
                || nExamDate2Year>3000 || nExamDate2Month<1 || nExamDate2Month>12)
                    strExamDate2 = "1753/01/01///";
                else
                {
                    strExamDate2Year=nExamDate2Year.toString();
                    strExamDate2Month=nExamDate2Month.toString();
                    if(strExamDate2Month.length == 1)
                        strExamDate2Month = '0'+strExamDate2Month;
                    strExamDate2 = strExamDate2Year+"/"+strExamDate2Month+"/01///";
                }
                if ("/////" == strExamDate2) 
                {
                    strExamDate2 = "1753/01/01///";
                }
                var strExamDate2 = strExamDate2.slice(0, 10).replace("/", "-").replace("/", "-") + " 00:00:00";

                var strExamName3 = OCX.GetObjectInfo("ComboBox_49", "text");
                var strExamResult3 = "异常";
                if("true" == OCX.GetObjectInfo("RadioBox_28", "checked"))
                    strExamResult3 = "正常";
                var strExamDate3 = "";//OCX.GetObjectInfo("DateTime_4", "text");
                //
                var strExamDate3Year = OCX.GetObjectInfo("TextBox_112", "text");
                var strExamDate3Month = OCX.GetObjectInfo("TextBox_111", "text");
                var nExamDate3Year = parseInt(strExamDate3Year, 10);
                var nExamDate3Month = parseInt(strExamDate3Month, 10);
                if(isNaN(nExamDate3Year) || isNaN(nExamDate3Month) || nExamDate3Year<1753 
                || nExamDate3Year>3000 || nExamDate3Month<1 || nExamDate3Month>12)
                    strExamDate3 = "1753/01/01///";
                else
                {
                    strExamDate3Year=nExamDate3Year.toString();
                    strExamDate3Month=nExamDate3Month.toString();
                    if(strExamDate3Month.length == 1)
                        strExamDate3Month='0'+strExamDate3Month;
                    strExamDate3 = strExamDate3Year+"/"+strExamDate3Month+"/01///";
                }
                if ("/////" == strExamDate3) 
                {
                    strExamDate3 = "1753/01/01///";
                }
                var strExamDate3 = strExamDate3.slice(0, 10).replace("/", "-").replace("/", "-") + " 00:00:00";

//                var strExamName4 = OCX.GetObjectInfo("ComboBox_50", "text");
//                var strExamResult4 = "异常";
//                if("true" == OCX.GetObjectInfo("RadioBox_29", "checked"))
//                    strExamResult4 = "正常";
//                var strExamDate4 = OCX.GetObjectInfo("DateTime_3", "text");
//                if ("/////" == strExamDate4) 
//                {
//                    strExamDate4 = "1753/01/01///";
//                }
//                var strExamDate4 = strExamDate4.slice(0, 10).replace("/", "-").replace("/", "-") + " 00:00:00";

                //get headache accompany
                var strHeadacheAccompanySymptom1 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_52", "checked"))
                    strHeadacheAccompanySymptom1 = "恶心";

                var strHeadacheAccompanySymptom2 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_45", "checked"))
                    strHeadacheAccompanySymptom2 = "呕吐";

                var strHeadacheAccompanySymptom3 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_44", "checked"))
                    strHeadacheAccompanySymptom3 = "畏光";

                var strHeadacheAccompanySymptom4 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_41", "checked"))
                    strHeadacheAccompanySymptom4 = "怕吵";

                var strHeadacheAccompanySymptom5 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_51", "checked"))
                    strHeadacheAccompanySymptom5 = "同侧鼻塞/流涕";

                var strHeadacheAccompanySymptom6 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_46", "checked"))
                    strHeadacheAccompanySymptom6 = "同侧结膜充血/流泪";

                var strHeadacheAccompanySymptom7 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_43", "checked"))
                    strHeadacheAccompanySymptom7 = "同侧前额/面部出汗";

                var strHeadacheAccompanySymptom8 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_50", "checked"))
                    strHeadacheAccompanySymptom8 = "同侧眼睑水肿";

                var strHeadacheAccompanySymptom9 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_47", "checked"))
                    strHeadacheAccompanySymptom9 = "同侧眼睑下垂";

                var strHeadacheAccompanySymptom10 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_42", "checked"))
                    strHeadacheAccompanySymptom10 = "同侧瞳孔缩小";

                var strHeadacheAccompanySymptom11 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_49", "checked"))
                    strHeadacheAccompanySymptom11 = "感觉不安或躁动";

                var strHeadacheAccompanySymptom12 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_48", "checked"))
                    strHeadacheAccompanySymptom12 = "其它";

                //get Mitigating information
                var strMitigatingFactor1 = "";
                var strMitigatingFactor2 = "";
                var strMitigatingFactor3 = "";
                var strMitigatingFactor4 = "";
                var strMitigatingFactor5 = "";
                var strMitigatingFactor6 = "";
                var strMitigatingFactor7 = "";
                var strMitigatingFactor8 = "";
                var strMitigatingFactor9 = "";
                var strMitigatingFactor10 = "";
                if("有" == OCX.GetObjectInfo("ComboBox_60", "text"))
                    strMitigatingFactor1 = "躺下";
                if("有" == OCX.GetObjectInfo("ComboBox_61", "text"))
                    strMitigatingFactor2 = "黑暗/安静的房间";
                if("有" == OCX.GetObjectInfo("ComboBox_62", "text"))
                    strMitigatingFactor3 = "按摩";
                if("有" == OCX.GetObjectInfo("ComboBox_63", "text"))
                    strMitigatingFactor4 = "热敷";
                if("有" == OCX.GetObjectInfo("ComboBox_64", "text"))
                    strMitigatingFactor5 = "冷敷";
                if("有" == OCX.GetObjectInfo("ComboBox_56", "text"))
                    strMitigatingFactor6 = "快步走";
                if("有" == OCX.GetObjectInfo("ComboBox_57", "text"))
                    strMitigatingFactor7 = "锻炼";
                if("有" == OCX.GetObjectInfo("ComboBox_58", "text"))
                    strMitigatingFactor8 = "站立";
                if("有" == OCX.GetObjectInfo("ComboBox_59", "text"))
                    strMitigatingFactor9 = "妊娠";
                if("" != OCX.GetObjectInfo("TextBox_64", "text"))
                    strMitigatingFactor10 = OCX.GetObjectInfo("TextBox_64", "text");

                //get Precipitating Factor
                var strPrecipitatingFactor1 = "";
                var strPrecipitatingFactor2 = "";
                var strPrecipitatingFactor3 = "";
                var strPrecipitatingFactor4 = "";
                var strPrecipitatingFactor5 = "";
                var strPrecipitatingFactor6 = "";
                var strPrecipitatingFactor7 = "";
                var strPrecipitatingFactor8 = "";
                var strPrecipitatingFactor9 = "";
                var strPrecipitatingFactor10 = "";
                var strPrecipitatingFactorDetail1 = OCX.GetObjectInfo("ComboBox_69", "text");
                var strPrecipitatingFactorDetail2 = OCX.GetObjectInfo("ComboBox_70", "text");
                var strPrecipitatingFactorDetail3 = OCX.GetObjectInfo("ComboBox_71", "text");
                var strPrecipitatingFactorDetail4 = OCX.GetObjectInfo("ComboBox_72", "text");
                var strPrecipitatingFactorDetail5 = OCX.GetObjectInfo("ComboBox_73", "text");
                var strPrecipitatingFactorDetail6 = OCX.GetObjectInfo("ComboBox_65", "text");
                var strPrecipitatingFactorDetail7 = OCX.GetObjectInfo("ComboBox_66", "text");
                var strPrecipitatingFactorDetail8 = OCX.GetObjectInfo("ComboBox_67", "text");
                var strPrecipitatingFactorDetail9 = OCX.GetObjectInfo("ComboBox_68", "text");
                var strPrecipitatingFactorDetail10 = OCX.GetObjectInfo("TextBox_65", "text");
                if("" != strPrecipitatingFactorDetail1)
                {
                    strPrecipitatingFactor1 = "睡眠";
                }
                if("" != strPrecipitatingFactorDetail2)
                {
                    strPrecipitatingFactor2 = "感觉刺激";
                }
                if("有" == strPrecipitatingFactorDetail3)
                {
                    strPrecipitatingFactorDetail3 = "";
                    strPrecipitatingFactor3 = "紧张/情绪波动";
                }
                if("" != strPrecipitatingFactorDetail4)
                {
                    strPrecipitatingFactor4 = "食物";
                }
                if("" != strPrecipitatingFactorDetail5)
                {
                    strPrecipitatingFactor5 = "活动";
                }
                if("" != strPrecipitatingFactorDetail6)
                {
                    strPrecipitatingFactor6 = "气候";
                }
                if("有" == strPrecipitatingFactorDetail7)
                {
                    strPrecipitatingFactorDetail7 = "";
                    strPrecipitatingFactor7 = "疲劳/放松";
                }
                if("" != strPrecipitatingFactorDetail8)
                {
                    strPrecipitatingFactor8 = "激素变化";
                }
                if("" != strPrecipitatingFactorDetail9)
                {
                    strPrecipitatingFactor9 = "体位";
                }
                if("" != strPrecipitatingFactorDetail10)
                {
                    strPrecipitatingFactor10 = "其他";
                }

                //HeadacheProdrome
                var strHeadacheProdrome1 = "";
                var strHeadacheProdrome2 = "";
                var strHeadacheProdrome3 = "";
                var strHeadacheProdrome4 = "";
                var strHeadacheProdrome5 = "";
                if("true" == OCX.GetObjectInfo("RadioBox_16", "checked"))
                    strHeadacheProdrome1 = "单侧视觉（点状/色斑/线型闪光幻觉/视野缺损）";
                if("true" == OCX.GetObjectInfo("RadioBox_19", "checked"))
                    strHeadacheProdrome5 = "双侧视觉（点状/色斑/线型闪光幻觉/视野缺损）";
                if("true" == OCX.GetObjectInfo("RadioBox_20", "checked"))
                    strHeadacheProdrome2 = "感觉（针刺感/麻木）";
                if("true" == OCX.GetObjectInfo("RadioBox_23", "checked"))
                    strHeadacheProdrome3 = "语言障碍";
                if("true" == OCX.GetObjectInfo("RadioBox_25", "checked"))
                    strHeadacheProdrome4 = "运动障碍";

                //get visit record
                var strChiefComplaint = OCX.GetObjectInfo("TextBox_12", "text");
                var strCDSSDiagnosis1 = OCX.GetObjectInfo("TextBox_14", "text");
                var strDiagnosisResult1 = OCX.GetObjectInfo("ComboBox_31", "text") + ":" + OCX.GetObjectInfo("ComboBox_32", "text");
                if("" == OCX.GetObjectInfo("ComboBox_32", "text"))
                    strDiagnosisResult1 = OCX.GetObjectInfo("ComboBox_31", "text");
                var strDiagnosisResult2 = OCX.GetObjectInfo("ComboBox_33", "text") + ":" + OCX.GetObjectInfo("ComboBox_34", "text");
                if("" == OCX.GetObjectInfo("ComboBox_34", "text"))
                    strDiagnosisResult2 = OCX.GetObjectInfo("ComboBox_33", "text");
                var strDiagnosisResult3 = OCX.GetObjectInfo("ComboBox_36", "text") + ":" + OCX.GetObjectInfo("ComboBox_35", "text");
                if("" == OCX.GetObjectInfo("ComboBox_35", "text"))
                    strDiagnosisResult3 = OCX.GetObjectInfo("ComboBox_36", "text");

                //prescription
                var strPrescription = "";

                var strDrug1Category = OCX.GetObjectInfo("TextBox_27", "text");
                var strDrug1Name = OCX.GetObjectInfo("TextBox_28", "text");
                var strDrug1Dose = OCX.GetObjectInfo("TextBox_29", "text");
                var strDrug1Application = OCX.GetObjectInfo("TextBox_30", "text");

                var strDrug2Category = OCX.GetObjectInfo("TextBox_31", "text");
                var strDrug2Name = OCX.GetObjectInfo("TextBox_32", "text");
                var strDrug2Dose = OCX.GetObjectInfo("TextBox_33", "text");
                var strDrug2Application = OCX.GetObjectInfo("TextBox_34", "text");

                var strDrug3Category = OCX.GetObjectInfo("TextBox_25", "text");
                var strDrug3Name = OCX.GetObjectInfo("TextBox_26", "text");
                var strDrug3Dose = OCX.GetObjectInfo("TextBox_43", "text");
                var strDrug3Application = OCX.GetObjectInfo("TextBox_46", "text");

                var strPrescriptionNote = OCX.GetObjectInfo("TextBox_47", "text");

                //PremonitorySymptom
                var strPremonitorySymptomGDHY = "";
                if("true" == OCX.GetObjectInfo("CheckBox_11", "checked"))
                    strPremonitorySymptomGDHY = "过度活跃";
                var strPremonitorySymptomTBDH = "";
                if("true" == OCX.GetObjectInfo("CheckBox_12", "checked"))
                    strPremonitorySymptomTBDH = "特别多话";
                var strPremonitorySymptomQS = "";
                if("true" == OCX.GetObjectInfo("CheckBox_13", "checked"))
                    strPremonitorySymptomQS = "沮丧";
                var strPremonitorySymptomYJR = "";
                if("true" == OCX.GetObjectInfo("CheckBox_14", "checked"))
                    strPremonitorySymptomYJR = "易激惹";
                var strPremonitorySymptomGJCD = "";
                if("true" == OCX.GetObjectInfo("CheckBox_15", "checked"))
                    strPremonitorySymptomGJCD = "感觉迟钝";
                var strPremonitorySymptomSS = "";
                if("true" == OCX.GetObjectInfo("CheckBox_19", "checked"))
                    strPremonitorySymptomSS = "思睡";
                var strPremonitorySymptomZLBA = "";
                if("true" == OCX.GetObjectInfo("CheckBox_20", "checked"))
                    strPremonitorySymptomZLBA = "坐立不安";
                var strPremonitorySymptomZYLZA = "";
                if("true" == OCX.GetObjectInfo("CheckBox_18", "checked"))
                    strPremonitorySymptomZYLZA = "注意力障碍";
                var strPremonitorySymptomWG = "";
                if("true" == OCX.GetObjectInfo("CheckBox_17", "checked"))
                    strPremonitorySymptomWG = "畏光";
                var strPremonitorySymptomWS = "";
                if("true" == OCX.GetObjectInfo("CheckBox_16", "checked"))
                    strPremonitorySymptomWS = "畏声";
                var strPremonitorySymptomWX = "";
                if("true" == OCX.GetObjectInfo("CheckBox_24", "checked"))
                    strPremonitorySymptomWX = "畏嗅";
                var strPremonitorySymptomYYKN = "";
                if("true" == OCX.GetObjectInfo("CheckBox_25", "checked"))
                    strPremonitorySymptomYYKN = "言语困难";
                var strPremonitorySymptomDHQ = "";
                if("true" == OCX.GetObjectInfo("CheckBox_23", "checked"))
                    strPremonitorySymptomDHQ = "打哈欠";
                var strPremonitorySymptomJBJYG = "";
                if("true" == OCX.GetObjectInfo("CheckBox_22", "checked"))
                    strPremonitorySymptomJBJYG = "颈部僵硬感";
                var strPremonitorySymptomYZXCDX = "";
                if("true" == OCX.GetObjectInfo("CheckBox_21", "checked"))
                    strPremonitorySymptomYZXCDX = "一直想吃东西";
                var strPremonitorySymptomWKBC = "";
                if("true" == OCX.GetObjectInfo("CheckBox_29", "checked"))
                    strPremonitorySymptomWKBC = "胃口变差";
                var strPremonitorySymptomGJL = "";
                if("true" == OCX.GetObjectInfo("CheckBox_30", "checked"))
                    strPremonitorySymptomGJL = "感觉冷";
                var strPremonitorySymptomFX = "";
                if("true" == OCX.GetObjectInfo("CheckBox_28", "checked"))
                    strPremonitorySymptomFX = "腹泻";
                var strPremonitorySymptomBM = "";
                if("true" == OCX.GetObjectInfo("CheckBox_27", "checked"))
                    strPremonitorySymptomBM = "便秘";
                var strPremonitorySymptomTBKK = "";
                if("true" == OCX.GetObjectInfo("CheckBox_26", "checked"))
                    strPremonitorySymptomTBKK = "特别口渴";
                var strPremonitorySymptomDN = "";
                if("true" == OCX.GetObjectInfo("CheckBox_34", "checked"))
                    strPremonitorySymptomDN = "多尿";
                var strPremonitorySymptomGJXR = "";
                if("true" == OCX.GetObjectInfo("CheckBox_35", "checked"))
                    strPremonitorySymptomGJXR = "感觉虚弱";
                var strPremonitorySymptomTY = "";
                if("true" == OCX.GetObjectInfo("CheckBox_33", "checked"))
                    strPremonitorySymptomTY = "头晕";
                var strPremonitorySymptomSZLSZ = "";
                if("true" == OCX.GetObjectInfo("CheckBox_32", "checked"))
                    strPremonitorySymptomSZLSZ = "水潴留、水肿";
                var strPremonitorySymptomQT = "";
                if("true" == OCX.GetObjectInfo("CheckBox_31", "checked"))
                    strPremonitorySymptomQT = "其他";
                
                //SleepStatus
                var strTimePerDay = OCX.GetObjectInfo("TextBox_59", "text");
                var strDifficultFallingAsleep = OCX.GetObjectInfo("ComboBox_25", "text");
                var strDreaminess = OCX.GetObjectInfo("ComboBox_27", "text");
                var strFestlessSleep = OCX.GetObjectInfo("ComboBox_26", "text");
                var strSleepyDayTime = OCX.GetObjectInfo("ComboBox_28", "text");

                //Disabilityevaluation
                var strHeadacheDays = OCX.GetObjectInfo("TextBox_57", "text");
                var strOutOfWorkDays = OCX.GetObjectInfo("TextBox_41", "text");
                var strAffectWorkDays = OCX.GetObjectInfo("TextBox_42", "text");
                var strOutOfHouseWorkDays = OCX.GetObjectInfo("TextBox_52", "text");
                var strAffectHouseWorkDays = OCX.GetObjectInfo("TextBox_53", "text");
                var strMissActivityDays = OCX.GetObjectInfo("TextBox_56", "text");

                //PHQ
                var strPHQ1 = OCX.GetObjectInfo("ComboBox_8", "text");
                var strPHQ2 = OCX.GetObjectInfo("ComboBox_9", "text");
                var strPHQ3 = OCX.GetObjectInfo("ComboBox_10", "text");
                var strPHQ4 = OCX.GetObjectInfo("ComboBox_11", "text");
                var strPHQ5 = OCX.GetObjectInfo("ComboBox_12", "text");
                var strPHQ6 = OCX.GetObjectInfo("ComboBox_13", "text");
                var strPHQ7 = OCX.GetObjectInfo("ComboBox_14", "text");
                var strPHQ8 = OCX.GetObjectInfo("ComboBox_15", "text");
                var strPHQ9 = OCX.GetObjectInfo("ComboBox_16", "text");
                var nPHQ1 = 0;
                var nPHQ2 = 0;
                var nPHQ3 = 0;
                var nPHQ4 = 0;
                var nPHQ5 = 0;
                var nPHQ6 = 0;
                var nPHQ7 = 0;
                var nPHQ8 = 0;
                var nPHQ9 = 0;
                var nPHQTotalScore = 0;

                if("好几天" == strPHQ1)
                    nPHQ1 = 1;
                else if("一半以上的天数" == strPHQ1)
                    nPHQ1 = 2;
                else if("几乎每天" == strPHQ1)
                    nPHQ1 = 3;

                if("好几天" == strPHQ2)
                    nPHQ2 = 1;
                else if("一半以上的天数" == strPHQ2)
                    nPHQ2 = 2;
                else if("几乎每天" == strPHQ2)
                    nPHQ2 = 3;

                if("好几天" == strPHQ3)
                    nPHQ3 = 1;
                else if("一半以上的天数" == strPHQ3)
                    nPHQ3 = 2;
                else if("几乎每天" == strPHQ3)
                    nPHQ3 = 3;

                if("好几天" == strPHQ4)
                    nPHQ4 = 1;
                else if("一半以上的天数" == strPHQ4)
                    nPHQ4 = 2;
                else if("几乎每天" == strPHQ4)
                    nPHQ4 = 3;

                if("好几天" == strPHQ5)
                    nPHQ5 = 1;
                else if("一半以上的天数" == strPHQ5)
                    nPHQ5 = 2;
                else if("几乎每天" == strPHQ5)
                    nPHQ5 = 3;

                if("好几天" == strPHQ6)
                    nPHQ6 = 1;
                else if("一半以上的天数" == strPHQ6)
                    nPHQ6 = 2;
                else if("几乎每天" == strPHQ6)
                    nPHQ6 = 3;

                if("好几天" == strPHQ7)
                    nPHQ7 = 1;
                else if("一半以上的天数" == strPHQ7)
                    nPHQ7 = 2;
                else if("几乎每天" == strPHQ7)
                    nPHQ7 = 3;

                if("好几天" == strPHQ8)
                    nPHQ8 = 1;
                else if("一半以上的天数" == strPHQ8)
                    nPHQ8 = 2;
                else if("几乎每天" == strPHQ8)
                    nPHQ8 = 3;

                if("好几天" == strPHQ9)
                    nPHQ9 = 1;
                else if("一半以上的天数" == strPHQ9)
                    nPHQ9 = 2;
                else if("几乎每天" == strPHQ9)
                    nPHQ9 = 3;

                nPHQTotalScore = nPHQ1 + nPHQ2 + nPHQ3 + nPHQ4 + nPHQ5 + nPHQ6 + nPHQ7 + nPHQ8 + nPHQ9;
                var strPHQTotalScore = nPHQTotalScore.toString();

                //GADQuestionaire
                var strGAD1 = OCX.GetObjectInfo("ComboBox_17", "text");
                var strGAD2 = OCX.GetObjectInfo("ComboBox_19", "text");
                var strGAD3 = OCX.GetObjectInfo("ComboBox_20", "text");
                var strGAD4 = OCX.GetObjectInfo("ComboBox_21", "text");
                var strGAD5 = OCX.GetObjectInfo("ComboBox_22", "text");
                var strGAD6 = OCX.GetObjectInfo("ComboBox_23", "text");
                var strGAD7 = OCX.GetObjectInfo("ComboBox_24", "text");

                var nGAD1 = 0;
                var nGAD2 = 0;
                var nGAD3 = 0;
                var nGAD4 = 0;
                var nGAD5 = 0;
                var nGAD6 = 0;
                var nGAD7 = 0;
                var nGADTotalScore = 0;

                if("几天" == strGAD1)
                    nGAD1 = 1;
                else if("一半以上的日子" == strGAD1)
                    nGAD1 = 2;
                else if("几乎每天" == strGAD1)
                    nGAD1 = 3;

                if("几天" == strGAD2)
                    nGAD2 = 1;
                else if("一半以上的日子" == strGAD2)
                    nGAD2 = 2;
                else if("几乎每天" == strGAD2)
                    nGAD2 = 3;

                if("几天" == strGAD3)
                    nGAD3 = 1;
                else if("一半以上的日子" == strGAD3)
                    nGAD3 = 2;
                else if("几乎每天" == strGAD3)
                    nGAD3 = 3;

                if("几天" == strGAD4)
                    nGAD4 = 1;
                else if("一半以上的日子" == strGAD4)
                    nGAD4 = 2;
                else if("几乎每天" == strGAD4)
                    nGAD4 = 3;

                if("几天" == strGAD5)
                    nGAD5 = 1;
                else if("一半以上的日子" == strGAD5)
                    nGAD5 = 2;
                else if("几乎每天" == strGAD5)
                    nGAD5 = 3;

                if("几天" == strGAD6)
                    nGAD6 = 1;
                else if("一半以上的日子" == strGAD6)
                    nGAD6 = 2;
                else if("几乎每天" == strGAD6)
                    nGAD6 = 3;
                
                if("几天" == strGAD7)
                    nGAD7 = 1;
                else if("一半以上的日子" == strGAD7)
                    nGAD7 = 2;
                else if("几乎每天" == strGAD7)
                    nGAD7 = 3;

                nGADTotalScore = nGAD1 + nGAD2 + nGAD3 + nGAD4 + nGAD5 + nGAD6 + nGAD7;
                var strGADTotalScore = nGADTotalScore.toString();

                //get medicine advice
                var strMedicineAdviceName1 = "";
                var strMedicineAdviceDosage1 = "";
                var strMedicineAdviceDosageUnit1 = "";
                var strMedicineAdviceInstruction1 = "";
                var strMedicineAdviceName2 = "";
                var strMedicineAdviceDosage2 = "";
                var strMedicineAdviceDosageUnit2 = "";
                var strMedicineAdviceInstruction2 = "";
                var strMedicineAdviceName3 = "";
                var strMedicineAdviceDosage3 = "";
                var strMedicineAdviceDosageUnit3 = "";
                var strMedicineAdviceInstruction3 = "";
                if("" != OCX.GetObjectInfo("TextBox_70", "text"))
                {
                    strMedicineAdviceName1 = OCX.GetObjectInfo("TextBox_70", "text");
                    strMedicineAdviceDosage1 = OCX.GetObjectInfo("TextBox_101", "text");
                    strMedicineAdviceDosageUnit1 = OCX.GetObjectInfo("ComboBox_77", "text");
                    strMedicineAdviceInstruction1 = OCX.GetObjectInfo("ComboBox_74", "text");
                    strMedicineAdviceName2 = OCX.GetObjectInfo("TextBox_69", "text");
                    strMedicineAdviceDosage2 = OCX.GetObjectInfo("TextBox_100", "text");
                    strMedicineAdviceDosageUnit2 = OCX.GetObjectInfo("ComboBox_76", "text");
                    strMedicineAdviceInstruction2 = OCX.GetObjectInfo("ComboBox_55", "text");
                    strMedicineAdviceName3 = OCX.GetObjectInfo("TextBox_68", "text");
                    strMedicineAdviceDosage3 = OCX.GetObjectInfo("TextBox_99", "text");
                    strMedicineAdviceDosageUnit3 = OCX.GetObjectInfo("ComboBox_75", "text");
                    strMedicineAdviceInstruction3 = OCX.GetObjectInfo("ComboBox_54", "text");                  
                }
                else if("" != OCX.GetObjectInfo("TextBox_60", "text"))
                {
                    strMedicineAdviceName1 = OCX.GetObjectInfo("TextBox_60", "text");
                    strMedicineAdviceDosage1 = OCX.GetObjectInfo("TextBox_95", "text");
                    strMedicineAdviceDosageUnit1 = OCX.GetObjectInfo("ComboBox_3", "text");
                    strMedicineAdviceInstruction1 = OCX.GetObjectInfo("ComboBox_4", "text");
                    strMedicineAdviceName2 = OCX.GetObjectInfo("TextBox_4", "text");
                    strMedicineAdviceDosage2 = OCX.GetObjectInfo("TextBox_94", "text");
                    strMedicineAdviceDosageUnit2 = OCX.GetObjectInfo("ComboBox_6", "text");
                    strMedicineAdviceInstruction2 = OCX.GetObjectInfo("ComboBox_5", "text");
                    strMedicineAdviceName3 = OCX.GetObjectInfo("TextBox_61", "text");
                    strMedicineAdviceDosage3 = OCX.GetObjectInfo("TextBox_93", "text");
                    strMedicineAdviceDosageUnit3 = OCX.GetObjectInfo("ComboBox_30", "text");
                    strMedicineAdviceInstruction3 = OCX.GetObjectInfo("ComboBox_29", "text");
                }
                else if("" != OCX.GetObjectInfo("TextBox_73", "text"))
                {
                    strMedicineAdviceName1 = OCX.GetObjectInfo("TextBox_73", "text");
                    strMedicineAdviceDosage1 = OCX.GetObjectInfo("TextBox_86", "text");
                    strMedicineAdviceDosageUnit1 = OCX.GetObjectInfo("ComboBox_78", "text");
                    strMedicineAdviceInstruction1 = OCX.GetObjectInfo("ComboBox_83", "text");
                    strMedicineAdviceName2 = OCX.GetObjectInfo("TextBox_72", "text");
                    strMedicineAdviceDosage2 = OCX.GetObjectInfo("TextBox_85", "text");
                    strMedicineAdviceDosageUnit2 = OCX.GetObjectInfo("ComboBox_79", "text");
                    strMedicineAdviceInstruction2 = OCX.GetObjectInfo("ComboBox_82", "text");
                    strMedicineAdviceName3 = OCX.GetObjectInfo("TextBox_71", "text");
                    strMedicineAdviceDosage3 = OCX.GetObjectInfo("TextBox_84", "text");
                    strMedicineAdviceDosageUnit3 = OCX.GetObjectInfo("ComboBox_80", "text");
                    strMedicineAdviceInstruction3 = OCX.GetObjectInfo("ComboBox_81", "text");
                }
                else if("" != OCX.GetObjectInfo("TextBox_76", "text"))
                {
                    strMedicineAdviceName1 = OCX.GetObjectInfo("TextBox_76", "text");
                    strMedicineAdviceDosage1 = OCX.GetObjectInfo("TextBox_81", "text");
                    strMedicineAdviceDosageUnit1 = OCX.GetObjectInfo("ComboBox_84", "text");
                    strMedicineAdviceInstruction1 = OCX.GetObjectInfo("ComboBox_89", "text");
                    strMedicineAdviceName2 = OCX.GetObjectInfo("TextBox_75", "text");
                    strMedicineAdviceDosage2 = OCX.GetObjectInfo("TextBox_82", "text");
                    strMedicineAdviceDosageUnit2 = OCX.GetObjectInfo("ComboBox_85", "text");
                    strMedicineAdviceInstruction2 = OCX.GetObjectInfo("ComboBox_88", "text");
                    strMedicineAdviceName3 = OCX.GetObjectInfo("TextBox_74", "text");
                    strMedicineAdviceDosage3 = OCX.GetObjectInfo("TextBox_83", "text");
                    strMedicineAdviceDosageUnit3 = OCX.GetObjectInfo("ComboBox_86", "text");
                    strMedicineAdviceInstruction3 = OCX.GetObjectInfo("ComboBox_87", "text");
                }
                else if("" != OCX.GetObjectInfo("TextBox_67", "text"))
                {
                    strMedicineAdviceName1 = OCX.GetObjectInfo("TextBox_67", "text");
                    strMedicineAdviceDosage1 = OCX.GetObjectInfo("TextBox_104", "text");
                    strMedicineAdviceDosageUnit1 = OCX.GetObjectInfo("ComboBox_51", "text");
                    strMedicineAdviceInstruction1 = OCX.GetObjectInfo("ComboBox_50", "text");
                    strMedicineAdviceName2 = OCX.GetObjectInfo("TextBox_66", "text");
                    strMedicineAdviceDosage2 = OCX.GetObjectInfo("TextBox_103", "text");
                    strMedicineAdviceDosageUnit2 = OCX.GetObjectInfo("ComboBox_52", "text");
                    strMedicineAdviceInstruction2 = OCX.GetObjectInfo("ComboBox_43", "text");
                    strMedicineAdviceName3 = OCX.GetObjectInfo("TextBox_63", "text");
                    strMedicineAdviceDosage3 = OCX.GetObjectInfo("TextBox_102", "text");
                    strMedicineAdviceDosageUnit3 = OCX.GetObjectInfo("ComboBox_53", "text");
                    strMedicineAdviceInstruction3 = OCX.GetObjectInfo("ComboBox_42", "text");
                }
                else if("" != OCX.GetObjectInfo("TextBox_79", "text"))
                {
                    strMedicineAdviceName1 = OCX.GetObjectInfo("TextBox_79", "text");
                    strMedicineAdviceDosage1 = OCX.GetObjectInfo("TextBox_107", "text");
                    strMedicineAdviceDosageUnit1 = OCX.GetObjectInfo("ComboBox_90", "text");
                    strMedicineAdviceInstruction1 = OCX.GetObjectInfo("ComboBox_95", "text");
                    strMedicineAdviceName2 = OCX.GetObjectInfo("TextBox_78", "text");
                    strMedicineAdviceDosage2 = OCX.GetObjectInfo("TextBox_106", "text");
                    strMedicineAdviceDosageUnit2 = OCX.GetObjectInfo("ComboBox_91", "text");
                    strMedicineAdviceInstruction2 = OCX.GetObjectInfo("ComboBox_94", "text");
                    strMedicineAdviceName3 = OCX.GetObjectInfo("TextBox_77", "text");
                    strMedicineAdviceDosage3 = OCX.GetObjectInfo("TextBox_105", "text");
                    strMedicineAdviceDosageUnit3 = OCX.GetObjectInfo("ComboBox_92", "text");
                    strMedicineAdviceInstruction3 = OCX.GetObjectInfo("ComboBox_93", "text");
                }

                var thing = { HFamilyMember: [ { Person: strFuQin}, { Person: strMuQin}, { Person: strXiongDi}
                                            , { Person: strJieMei}, { Person: strErZi}, { Person: strNvEr}
                                            , { Person: strZuFu}, { Person: strZiMu}, { Person: strWaiZuFu}
                                            , { Person: strWaiZuMu}, { Person: strHFamilyMemberQiTa} ],
                              MAdvice:[{DrugApplication: strMedicineAdviceInstruction1, DrugName: strMedicineAdviceName1, DrugDose: strMedicineAdviceDosage1, DrugDoseUnit:strMedicineAdviceDosageUnit1}
                                                    ,{DrugApplication: strMedicineAdviceInstruction2, DrugName: strMedicineAdviceName2, DrugDose: strMedicineAdviceDosage2, DrugDoseUnit:strMedicineAdviceDosageUnit2}
                                                    ,{DrugApplication: strMedicineAdviceInstruction3, DrugName: strMedicineAdviceName3, DrugDose: strMedicineAdviceDosage3, DrugDoseUnit:strMedicineAdviceDosageUnit3}],
                              OFamilyDisease: [ {DiseaseName: strXinZangJiBin}, {DiseaseName: strDianXian}, {DiseaseName: strGaoXueYa}
                                            , {DiseaseName: strZuZhong}, {DiseaseName: strGuanJieYan}, {DiseaseName: strZhongLiu}
                                            , {DiseaseName: strJiaoLv}, {DiseaseName: strOFamilyDiseaseQiTa} ],
                              lifestyle: {TeaPerDay:strTeaPerDay, CoffePerDay: strCoffePerDay, SmokeState: bIfAlwaysSmoke, SmokeYear: strSmokeYears, DrinkState: bIfAlwaysDrink, DrinkYear: strDrinkYears, ExerciseOften: bIfAlwaysExercise},
                              Sleepstatus: {TimePerDay:strTimePerDay, DifficultFallingAsleep:strDifficultFallingAsleep, Dreaminess:strDreaminess, FestlessSleep:strFestlessSleep, SleepyDayTime:strSleepyDayTime},
                              Disabilityevaluation: {HeadacheDays:strHeadacheDays, OutOfWorkDays:strOutOfWorkDays, AffectWorkDays:strAffectWorkDays, OutOfHouseWorkDays:strOutOfHouseWorkDays, AffectHouseWorkDays:strAffectHouseWorkDays, MissActivityDays:strMissActivityDays},
                              PHquestionaire: {Q1: strPHQ1, Q2: strPHQ2, Q3: strPHQ3, Q4: strPHQ4, Q5: strPHQ5, Q6: strPHQ6, Q7: strPHQ7, Q8: strPHQ8, Q9: strPHQ9, TotalScore: strPHQTotalScore},
                              GADquestionaire: {Q1: strGAD1, Q2: strGAD2, Q3: strGAD3, Q4: strGAD4, Q5: strGAD5, Q6: strGAD6, Q7: strGAD7, TotalScore: strGADTotalScore},
                              PDrug: [{DrugCategory: strDrugCategory1, DrugApplication: strDrugApplication1, DayAmoutnPerM: strDayAmoutnPerM1, MonthTotalAmount: strMonthTotalAmount1}
                                        ,{DrugCategory: strDrugCategory2, DrugApplication: strDrugApplication2, DayAmoutnPerM: strDayAmoutnPerM2, MonthTotalAmount: strMonthTotalAmount2}
                                        ,{DrugCategory: strDrugCategory3, DrugApplication: strDrugApplication3, DayAmoutnPerM: strDayAmoutnPerM3, MonthTotalAmount: strMonthTotalAmount3}
                                        ,{DrugCategory: strDrugCategoryPNLE1, DrugApplication: strDrugApplicationPNLE1, DrugName: strDrugNamePNLE1}
                                        ,{DrugCategory: strDrugCategoryPNLE2, DrugApplication: strDrugApplicationPNLE2, DrugName: strDrugNamePNLE2}
                                        ,{DrugCategory: strDrugCategoryPNLE3, DrugApplication: strDrugApplicationPNLE3, DrugName: strDrugNamePNLE3}
                                        ,{DrugCategory: strDrugCategoryPNLE4, DrugApplication: strDrugApplicationPNLE4, DrugName: strDrugNamePNLE4}
                                        ,{DrugCategory: strDrugCategoryPNLE5, DrugApplication: strDrugApplicationPNLE5, DrugName: strDrugNamePNLE5}
                                        ,{DrugCategory: strDrugCategoryPNLE6, DrugApplication: strDrugApplicationPNLE6, DrugName: strDrugNamePNLE6}
                                        ,{DrugCategory: strDrugCategoryPNLE7, DrugApplication: strDrugApplicationPNLE7, DrugName: strDrugNamePNLE7}
                                        ,{DrugCategory: strDrugCategoryPNLE8, DrugApplication: strDrugApplicationPNLE8, DrugName: strDrugNamePNLE8}
                                        ,{DrugCategory: strDrugCategoryPNLE9, DrugApplication: strDrugApplicationPNLE9, DrugName: strDrugNamePNLE9}
                                        ,{DrugCategory: strDrugCategoryPNLE10, DrugApplication: strDrugApplicationPNLE10, DrugName: strDrugNamePNLE10}
                                        ,{DrugCategory: strDrugCategoryPNLE11, DrugApplication: strDrugApplicationPNLE11, DrugName: strDrugNamePNLE11}
                                        ,{DrugCategory: strDrugCategoryPNLE12, DrugApplication: strDrugApplicationPNLE12, DrugName: strDrugNamePNLE12}
                                        ,{DrugCategory: strDrugCategoryPNLE13, DrugApplication: strDrugApplicationPNLE13, DrugName: strDrugNamePNLE13}
                                        ,{DrugCategory: strDrugCategoryPNLE14, DrugApplication: strDrugApplicationPNLE14, DrugName: strDrugNamePNLE14}
                                        ,{DrugCategory: strDrugCategoryPNLE15, DrugApplication: strDrugApplicationPNLE15, DrugName: strDrugNamePNLE15}
                                        ,{DrugCategory: strDrugCategoryPNLE16, DrugApplication: strDrugApplicationPNLE16, DrugName: strDrugNamePNLE16}
                                        ,{DrugCategory: strDrugCategoryPNLE17, DrugApplication: strDrugApplicationPNLE17, DrugName: strDrugNamePNLE17}
                                        ,{DrugCategory: strDrugCategoryPNLE18, DrugApplication: strDrugApplicationPNLE18, DrugName: strDrugNamePNLE18}
                                        ,{DrugCategory: strDrugCategoryPNLE19, DrugApplication: strDrugApplicationPNLE19, DrugName: strDrugNamePNLE19}
                                        ,{DrugCategory: strDrugCategoryPNLE20, DrugApplication: strDrugApplicationPNLE20, DrugName: strDrugNamePNLE20}],
                              PExam: [{ExamName: strExamName1, Result:strExamResult1, Date:strExamDate1}
                                        ,{ExamName: strExamName2, Result:strExamResult2, Date:strExamDate2}
                                        ,{ExamName: strExamName3, Result:strExamResult3, Date:strExamDate3}],
                              PHeadacheOverview: {HeadacheType: strHeadacheType, HeadacheDegree: strHeadacheDegree, HeadcheTime: strHeadcheTime
                                                    , HeacheTimeUnit: strHeacheTimeUnit, FrequencyPerMonth: strFrequencyPerMonth
                                                    , OnsetFixedPeriod: strIfFixed, OnsetDate: strOnsetDate
                                                    , OnsetAmount: strOnsetAmount, DailyAggravation: strDailyAggravation, FirstOnsetContinue: strFirstOnsetContinue
                                                    , HeadachePlace:[{Position: strHeadachePlace, SpecificPlace: strSpecificPlace1}, {Position: strHeadachePlace, SpecificPlace: strSpecificPlace2}
                                                                        , {Position: strHeadachePlace, SpecificPlace: strSpecificPlace1}, {Position: strHeadachePlace, SpecificPlace: strSpecificPlace2}
                                                                        , {Position: strHeadachePlace, SpecificPlace: strSpecificPlace3}, {Position: strHeadachePlace, SpecificPlace: strSpecificPlace4}
                                                                        , {Position: strHeadachePlace, SpecificPlace: strSpecificPlace5}, {Position: strHeadachePlace, SpecificPlace: strSpecificPlace6}
                                                                        , {Position: strHeadachePlace, SpecificPlace: strSpecificPlace7}, {Position: strHeadachePlace, SpecificPlace: strSpecificPlace8}
                                                                        , {Position: strHeadachePlace, SpecificPlace: strSpecificPlace9}, {Position: strHeadachePlace, SpecificPlace: strSpecificPlace10}
                                                                        , {Position: strHeadachePlace, SpecificPlace: strSpecificPlace11}, {Position: "", SpecificPlace: strSpecificPlace12}
                                                                        , {Position: "", SpecificPlace: strSpecificPlace13}]
                                                    , HeadacheAccompany: [{Symptom: strHeadacheAccompanySymptom1},{Symptom: strHeadacheAccompanySymptom2}
                                                                            , {Symptom: strHeadacheAccompanySymptom3},{Symptom: strHeadacheAccompanySymptom4}
                                                                            , {Symptom: strHeadacheAccompanySymptom5},{Symptom: strHeadacheAccompanySymptom6}
                                                                            , {Symptom: strHeadacheAccompanySymptom7},{Symptom: strHeadacheAccompanySymptom8}
                                                                            , {Symptom: strHeadacheAccompanySymptom9},{Symptom: strHeadacheAccompanySymptom10}
                                                                            , {Symptom: strHeadacheAccompanySymptom11},{Symptom: strHeadacheAccompanySymptom12}]
                                                    , MitigatingFactors: [ {FactorName: strMitigatingFactor1}, {FactorName: strMitigatingFactor2}, {FactorName: strMitigatingFactor3}
                                                                            , {FactorName: strMitigatingFactor4}, {FactorName: strMitigatingFactor5}, {FactorName: strMitigatingFactor6}
                                                                            , {FactorName: strMitigatingFactor7}, {FactorName: strMitigatingFactor8}, {FactorName: strMitigatingFactor9}
                                                                            , {FactorName: strMitigatingFactor10} ]
                                                    , PrecipitatingFactor: [ {FactorName: strPrecipitatingFactor1, FactorDetail: strPrecipitatingFactorDetail1}, {FactorName: strPrecipitatingFactor2, FactorDetail: strPrecipitatingFactorDetail2}, {FactorName: strPrecipitatingFactor3, FactorDetail: strPrecipitatingFactorDetail3}
                                                                            , {FactorName: strPrecipitatingFactor4, FactorDetail: strPrecipitatingFactorDetail4}, {FactorName: strPrecipitatingFactor5, FactorDetail: strPrecipitatingFactorDetail5}, {FactorName: strPrecipitatingFactor6, FactorDetail: strPrecipitatingFactorDetail6}
                                                                            , {FactorName: strPrecipitatingFactor7, FactorDetail: strPrecipitatingFactorDetail7}, {FactorName: strPrecipitatingFactor8, FactorDetail: strPrecipitatingFactorDetail8}, {FactorName: strPrecipitatingFactor9, FactorDetail: strPrecipitatingFactorDetail9}
                                                                            , {FactorName: strPrecipitatingFactor10, FactorDetail: strPrecipitatingFactorDetail10} ]
                                                    , HeadacheProdrome: [ {Prodrome: strHeadacheProdrome1}, {Prodrome: strHeadacheProdrome2}, {Prodrome: strHeadacheProdrome3}, {Prodrome: strHeadacheProdrome4}, {Prodrome: strHeadacheProdrome5} ]
                                                    , PremonitorySymptom: [ {Symptom: strPremonitorySymptomGDHY}, {Symptom: strPremonitorySymptomTBDH}, {Symptom: strPremonitorySymptomQS}, {Symptom: strPremonitorySymptomYJR}, {Symptom: strPremonitorySymptomGJCD} 
                                                                            , {Symptom: strPremonitorySymptomSS}, {Symptom: strPremonitorySymptomZLBA}, {Symptom: strPremonitorySymptomZYLZA}, {Symptom: strPremonitorySymptomWG}, {Symptom: strPremonitorySymptomWS}
                                                                            , {Symptom: strPremonitorySymptomWX}, {Symptom: strPremonitorySymptomYYKN}, {Symptom: strPremonitorySymptomDHQ}, {Symptom: strPremonitorySymptomJBJYG}, {Symptom: strPremonitorySymptomYZXCDX}
                                                                            , {Symptom: strPremonitorySymptomWKBC}, {Symptom: strPremonitorySymptomGJL}, {Symptom: strPremonitorySymptomFX}, {Symptom: strPremonitorySymptomBM}, {Symptom: strPremonitorySymptomTBKK}
                                                                            , {Symptom: strPremonitorySymptomDN}, {Symptom: strPremonitorySymptomGJXR}, {Symptom: strPremonitorySymptomTY}, {Symptom: strPremonitorySymptomSZLSZ}, {Symptom: strPremonitorySymptomQT} ]},
                              visitrecord: {ChiefComplaint: strChiefComplaint, CDSSDiagnosis1: strCDSSDiagnosis1
                                                    ,DiagnosisResult1: strDiagnosisResult1, DiagnosisResult2: strDiagnosisResult2, DiagnosisResult3: strDiagnosisResult3
                                                    ,Prescription: strPrescription, PreviousDiagnosis: strPreviousDiagnosis
                                                    ,SecondaryHeadacheSymptom:[{Symptom: strSecondaryHeadacheSymptom1}, {Symptom: strSecondaryHeadacheSymptom2}, {Symptom: strSecondaryHeadacheSymptom3}
                                                                                , {Symptom: strSecondaryHeadacheSymptom4}, {Symptom: strSecondaryHeadacheSymptom5}, {Symptom: strSecondaryHeadacheSymptom6}
                                                                                , {Symptom: strSecondaryHeadacheSymptom7}, {Symptom: strSecondaryHeadacheSymptom8}, {Symptom: strSecondaryHeadacheSymptom9}
                                                                                , {Symptom: strSecondaryHeadacheSymptom10}]
                                                    ,PrescriptionNote: strPrescriptionNote}

                                             };
            return thing;
    }
    
    function GetChiefComplaint(OCX)
    {
        var strChiefComplaint = "";

        //get SecondaryHeadacheSymptoms
        strChiefComplaint += "继发性头痛筛查:";
        if("true" == OCX.GetObjectInfo("CheckBox_1", "checked"))
            strChiefComplaint += " " + "突然发生的头痛";
        if("true" == OCX.GetObjectInfo("CheckBox_2", "checked"))
            strChiefComplaint += " " + "逐渐加重的头痛";
        if("true" == OCX.GetObjectInfo("CheckBox_3", "checked"))
            strChiefComplaint += " " + "伴有系统性病变征象（发热、颈强直、皮疹）的头痛";
        if("true" == OCX.GetObjectInfo("CheckBox_4", "checked"))
            strChiefComplaint += " " + "神经系统局灶症状和体征（除典型的视觉、感觉先兆之外）";
        if("true" == OCX.GetObjectInfo("CheckBox_5", "checked"))
            strChiefComplaint += " " + "伴有认知障碍的头痛";
        if("true" == OCX.GetObjectInfo("CheckBox_6", "checked"))
            strChiefComplaint += " " + "视乳头水肿";
        if("true" == OCX.GetObjectInfo("CheckBox_7", "checked"))
            strChiefComplaint += " " + "由咳嗽、用力动作诱发的头痛";
        if("true" == OCX.GetObjectInfo("CheckBox_8", "checked"))
            strChiefComplaint += " " + "妊娠期或产后头痛";
        if("true" == OCX.GetObjectInfo("CheckBox_9", "checked"))
            strChiefComplaint += " " + "癌症患者或AIDS患者出现新发头痛";
        if("true" == OCX.GetObjectInfo("CheckBox_10", "checked"))
            strChiefComplaint += " " + "50岁后的新发头痛";

        if(strChiefComplaint == "继发性头痛筛查:")
            strChiefComplaint = "";

        if("" == strChiefComplaint)
        {
            var strChiefComplaint = "头痛";
            //get the PrimaryHeadacheOverView information
            var strOnsetDate = "";//OCX.GetObjectInfo("DateTime_2", "text");
            //
            var strOnsetDateYear = OCX.GetObjectInfo("TextBox_80", "text");
            var strOnsetDateMonth = OCX.GetObjectInfo("TextBox_108", "text");
            var nOnsetDateYear = parseInt(strOnsetDateYear, 10);
            var nOnsetDateMonth = parseInt(strOnsetDateMonth, 10);
            if(isNaN(nOnsetDateYear) || isNaN(nOnsetDateMonth) || nOnsetDateYear<1753 
            || nOnsetDateYear>3000 || nOnsetDateMonth<1 || nOnsetDateMonth>12)
                strOnsetDate = "1753/01/01///";
            else
            {
                strOnsetDateYear=nOnsetDateYear.toString();
                strOnsetDateMonth=nOnsetDateMonth.toString();
                if(strOnsetDateMonth.length == 1)
                        strOnsetDateMonth = '0'+strOnsetDateMonth;
                strOnsetDate = strOnsetDateYear+"/"+strOnsetDateMonth+"/01///";
            }
            if ("/////" != strOnsetDate) 
            {
                var nOnsetYear = parseInt(strOnsetDate.substring(0, strOnsetDate.indexOf("/")));
                var strOnsetExceptYear = strOnsetDate.substring(strOnsetDate.indexOf("/") + 1);
                var nOnsetMonth = parseInt(strOnsetExceptYear.substring(0, strOnsetExceptYear.indexOf("/")));
                today = new Date();
                var nTodayYear = today.getFullYear();
                var nTodayMonth = today.getMonth() + 1;

                var nMonth = 0;
                var nYear = 0;
                if(nTodayMonth > nOnsetMonth)
                {
                    nMonth = nTodayMonth - nOnsetMonth;
                }
                else if(nTodayMonth < nOnsetMonth)
                {
                    nMonth = nTodayMonth + 12 - nOnsetMonth;
                    nTodayYear -= 1;
                }
                nYear = nTodayYear - nOnsetYear;
                if(0 < nYear)
                    strChiefComplaint += nYear.toString() + "年" + nMonth.toString() + "个月。";
                else
                    strChiefComplaint += nMonth.toString() + "个月。";

                strChiefComplaint += "\n";
            }

            //get headache place
            var strHeadachePlace = "";
            var strSpecificPlace1 = "";
            var strSpecificPlace2 = "";
            var strSpecificPlace3 = "";
            var strSpecificPlace4 = "";
            var strSpecificPlace5 = "";
            var strSpecificPlace6 = "";
            var strSpecificPlace7 = "";
            var strSpecificPlace8 = "";
            var strSpecificPlace9 = "";
            var strSpecificPlace10 = "";
            var strSpecificPlace11 = "";
            var strSpecificPlace12 = "";
            var strSpecificPlace13 = "";
                    
            if(document.getElementById("bi").checked)
                strHeadachePlace = "双侧 : ";
            if(document.getElementById("unileft").checked)
            strHeadachePlace ="左侧 : ";
            if(document.getElementById("uniright").checked)
                strHeadachePlace = "右侧 : ";
            var value=GetHeadachePlace();   
            if(value[7])
                strSpecificPlace1 = "颞部、";
            if(value[1])
                strSpecificPlace2 = "枕部、";
            if(value[4])
                strSpecificPlace3 = "顶部、";
            if(value[6])
                strSpecificPlace4 = "眶部、";
            if(value[2])
                strSpecificPlace5 = "颈部、";
            if(value[5])
                strSpecificPlace6 = "颌部、";
            if(value[8])
                strSpecificPlace8 = "脸部、";
            if(value[0])
                strSpecificPlace9 = "耳部、";
            if(value[3])
                strSpecificPlace11 = "前额";
            if("true" == OCX.GetObjectInfo("CheckBox_QuanHeadache", "checked"))
                strSpecificPlace12 = "，全头痛";
            if("true" == OCX.GetObjectInfo("CheckBox_OtherHeadache", "checked"))
                strSpecificPlace13 = "，其他";
                    
            strChiefComplaint += "    ";
            strChiefComplaint += "头痛部位为" + strHeadachePlace + strSpecificPlace1 + strSpecificPlace2 + strSpecificPlace3
                                + strSpecificPlace4 + strSpecificPlace5 + strSpecificPlace6 + strSpecificPlace7
                                + strSpecificPlace8 + strSpecificPlace9 + strSpecificPlace10 + strSpecificPlace11
                                + strSpecificPlace12 + strSpecificPlace13;
            
            var strHeadacheType = OCX.GetObjectInfo("ComboBox_40", "text");
            strChiefComplaint += strHeadacheType + "，";
            //头痛评分
            var strHeadacheDegree = OCX.GetObjectInfo("ComboBox_41", "text");
            strChiefComplaint += "VAS评分=" + strHeadacheDegree + "分，";

            if("true" == OCX.GetObjectInfo("CheckBox_52", "checked"))
                strChiefComplaint += "伴";
            else
                strChiefComplaint += "无";
            strChiefComplaint += "恶心、";
                    
            if("true" == OCX.GetObjectInfo("CheckBox_45", "checked"))
                strChiefComplaint += "伴";
            else
                strChiefComplaint += "无";
            strChiefComplaint += "呕吐、";
                    
            if("true" == OCX.GetObjectInfo("CheckBox_41", "checked"))
                strChiefComplaint += "伴";
            else
                strChiefComplaint += "无";
            strChiefComplaint += "畏声、";
                    
            if("true" == OCX.GetObjectInfo("CheckBox_44", "checked"))
                strChiefComplaint += "伴";
            else
                strChiefComplaint += "无";
            strChiefComplaint += "畏光；";
                    
            if("true" == OCX.GetObjectInfo("CheckBox_51", "checked"))
                strChiefComplaint += "伴";
            else
                strChiefComplaint += "无";
            strChiefComplaint += "同侧鼻塞/流涕、";
                    
            if("true" == OCX.GetObjectInfo("CheckBox_46", "checked"))
                strChiefComplaint += "伴";
            else
                strChiefComplaint += "无";
            strChiefComplaint += "同侧结膜充血/流泪、";
                    
            if("true" == OCX.GetObjectInfo("CheckBox_43", "checked"))
                strChiefComplaint += "伴";
            else
                strChiefComplaint += "无";
            strChiefComplaint += "同侧前额/面部出汗、";
                    
            if("true" == OCX.GetObjectInfo("CheckBox_50", "checked"))
                strChiefComplaint += "伴";
            else
                strChiefComplaint += "无";
            strChiefComplaint += "同侧眼睑水肿、";
                    
            if("true" == OCX.GetObjectInfo("CheckBox_47", "checked"))
                strChiefComplaint += "伴";
            else
                strChiefComplaint += "无";
            strChiefComplaint += "同侧眼睑下垂、";
                    
            if("true" == OCX.GetObjectInfo("CheckBox_42", "checked"))
                strChiefComplaint += "伴";
            else
                strChiefComplaint += "无";
            strChiefComplaint += "同侧瞳孔缩小、";
                    
            if("true" == OCX.GetObjectInfo("CheckBox_49", "checked"))
                strChiefComplaint += "伴";
            else
                strChiefComplaint += "无";
            strChiefComplaint += "感觉躁动会不安。"

            strChiefComplaint += "共发作";        

            var strOnsetAmount = "";
            if("true" == OCX.GetObjectInfo("RadioBox_15", "checked"))
                strOnsetAmount = "<5次，";
            else if("true" == OCX.GetObjectInfo("RadioBox_14", "checked"))
                strOnsetAmount = "6-9次，";
            else if("true" == OCX.GetObjectInfo("RadioBox_12", "checked"))
                strOnsetAmount = "超过10次，";
            else if("true" == OCX.GetObjectInfo("RadioBox_13", "checked"))
                strOnsetAmount = "超过10次，";
            strChiefComplaint += strOnsetAmount;
                    
            if("是" == OCX.GetObjectInfo("ComboBox_37", "text"))
                strChiefComplaint += "首次发作即每日头痛，";
                    
            var strIfFixed = OCX.GetObjectInfo("ComboBox_1", "text");
            if("是" == strIfFixed)
                strChiefComplaint += "头痛周期性发作，";

            strChiefComplaint += "头痛前有";                   
            if("true" == OCX.GetObjectInfo("RadioBox_16", "checked"))
                strChiefComplaint += "单侧视觉、";
            if("true" == OCX.GetObjectInfo("RadioBox_19", "checked"))
                strChiefComplaint += "双侧视觉、";
            if("true" == OCX.GetObjectInfo("RadioBox_20", "checked"))
                strChiefComplaint += "感觉、";
            if("true" == OCX.GetObjectInfo("RadioBox_23", "checked"))
                strChiefComplaint += "语言障碍、";
            if("true" == OCX.GetObjectInfo("RadioBox_25", "checked"))
                strChiefComplaint += "运动障碍";
            if("有" == strChiefComplaint.charAt(strChiefComplaint.length - 1))
                strChiefComplaint = strChiefComplaint.substring(0, strChiefComplaint.length - 1) + "无";
            strChiefComplaint += "先兆。";

            var strDailylifeSharpening = OCX.GetObjectInfo("ComboBox_38", "text");
            if("无" == strDailylifeSharpening)
                strChiefComplaint += "日常活动不加重头痛，";
            else
                strChiefComplaint += "日常活动加重头痛，";
                    
            var strHeadcheTime = OCX.GetObjectInfo("TextBox_40", "text");
            var strHeacheTimeUnit = OCX.GetObjectInfo("ComboBox_39", "text");
            strChiefComplaint += "每次头痛时间" + strHeadcheTime + strHeacheTimeUnit + ",";
                    
            //var strFrequencyPerMonth = OCX.GetObjectInfo("ComboBox_7", "text");
            var strFrequencyPerMonth = "";
                if("true" == OCX.GetObjectInfo("RadioBox_7", "checked"))
                    strFrequencyPerMonth = "<1";
                else if("true" == OCX.GetObjectInfo("RadioBox_8", "checked"))
                    strFrequencyPerMonth = "1-15";
                else if("true" == OCX.GetObjectInfo("RadioBox_9", "checked"))
                    strFrequencyPerMonth = ">15";
            strChiefComplaint += "每月发作" + strFrequencyPerMonth + "天。";
                    
            //get PreviousExam
            var strExamName1 = OCX.GetObjectInfo("ComboBox_47", "text");
            var strExamResult1 = "";
            if("true" == OCX.GetObjectInfo("RadioBox_26", "checked"))
                strExamResult1 = "正常";
            else if("true" == OCX.GetObjectInfo("RadioBox_30", "checked"))
                strExamResult1 = "异常";
            //
            var strExamDate1Year = OCX.GetObjectInfo("TextBox_110", "text");
            var strExamDate1Month = OCX.GetObjectInfo("TextBox_109", "text");
            var nExamDate1Year = parseInt(strExamDate1Year, 10);
            var nExamDate1Month = parseInt(strExamDate1Month, 10);
            if(isNaN(nExamDate1Year) || isNaN(nExamDate1Month) || nExamDate1Year<1753 
            || nExamDate1Year>3000 || nExamDate1Month<1 || nExamDate1Month>12)
                strExamDate1 = "///";
            else
            {
                strExamDate1Year=nExamDate1Year.toString();
                strExamDate1Month=nExamDate1Month.toString();
                strExamDate1 = strExamDate1Year+"/"+strExamDate1Month+"/01///";
            }
            strExamDate1 = strExamDate1.substring(0, strExamDate1.length-3);
            if ("///" != strExamDate1 && "" != strExamResult1) 
            {
                strChiefComplaint += "曾于" + strExamDate1 + "做过" + strExamName1 + "，检查结果" + strExamResult1 + "；";
            }
            else if("///" == strExamDate1 && "" != strExamResult1)
            {
                strChiefComplaint += "做过" + strExamName1 + "，检查结果" + strExamResult1 + "；";
            }
                    
            var strExamName2 = OCX.GetObjectInfo("ComboBox_48", "text");
            var strExamResult2 = "";
            if("true" == OCX.GetObjectInfo("RadioBox_27", "checked"))
                strExamResult2 = "正常";
            else if("true" == OCX.GetObjectInfo("RadioBox_31", "checked"))
                strExamResult2 = "异常";
            var strExamDate2 = "";//OCX.GetObjectInfo("DateTime_5", "text");
            //
            var strExamDate2Year = OCX.GetObjectInfo("TextBox_112", "text");
            var strExamDate2Month = OCX.GetObjectInfo("TextBox_111", "text");
            var nExamDate2Year = parseInt(strExamDate2Year, 10);
            var nExamDate2Month = parseInt(strExamDate2Month, 10);
            if(isNaN(nExamDate2Year) || isNaN(nExamDate2Month) || nExamDate2Year<1753 
            || nExamDate2Year>3000 || nExamDate2Month<1 || nExamDate2Month>12)
                strExamDate2 = "///";
            else
            {
                strExamDate2Year=nExamDate2Year.toString();
                strExamDate2Month=nExamDate2Month.toString();
                strExamDate2 = strExamDate2Year+"/"+strExamDate2Month+"/01///";
            }
            strExamDate2 = strExamDate2.substring(0, strExamDate2.length-3);
            if ("///" != strExamDate2 && "" == strExamResult2) 
            {
                strChiefComplaint += "曾于" + strExamDate2 + "做过" + strExamName2 + "，检查结果" + strExamResult2 + "；";
            }
            else if("///" == strExamDate2 && "" == strExamResult2)
            {
                strChiefComplaint += "做过" + strExamName2 + "，检查结果" + strExamResult2 + "；";
                
            }
                    
            var strExamName3 = OCX.GetObjectInfo("ComboBox_49", "text");
            var strExamResult3 = "";
            if("true" == OCX.GetObjectInfo("RadioBox_28", "checked"))
                strExamResult3 = "正常";
            if("true" == OCX.GetObjectInfo("RadioBox_32", "checked"))
                strExamResult3 = "异常";
            var strExamDate3 = "";//OCX.GetObjectInfo("DateTime_4", "text");
            //
            var strExamDate3Year = OCX.GetObjectInfo("TextBox_112", "text");
            var strExamDate3Month = OCX.GetObjectInfo("TextBox_111", "text");
            var nExamDate3Year = parseInt(strExamDate3Year, 10);
            var nExamDate3Month = parseInt(strExamDate3Month, 10);
            if(isNaN(nExamDate3Year) || isNaN(nExamDate3Month) || nExamDate3Year<1753 
            || nExamDate3Year>3000 || nExamDate3Month<1 || nExamDate3Month>12)
                strExamDate3 = "///";
            else
            {
                strExamDate3Year=nExamDate3Year.toString();
                strExamDate3Month=nExamDate3Month.toString();
                strExamDate3 = strExamDate3Year+"/"+strExamDate3Month+"/01///";
            }
            strExamDate3 = strExamDate3.substring(0, strExamDate3.length-3);
            if ("///" != strExamDate3 && "" == strExamDate3) 
            {
                strChiefComplaint += "曾于" + strExamDate3 + "做过" + strExamName3 + "，检查结果" + strExamResult3 + "；";
            }
            else if("///" == strExamDate3 && "" == strExamDate3)
            {
                strChiefComplaint += "做过" + strExamName3 + "，检查结果" + strExamResult3 + "；";
            }
                    
//            var strExamName4 = OCX.GetObjectInfo("ComboBox_50", "text");
//            var strExamResult4 = "";
//            if("true" == OCX.GetObjectInfo("RadioBox_29", "checked"))
//                strExamResult4 = "正常";
//            else if("true" == OCX.GetObjectInfo("RadioBox_33", "checked"))
//                strExamResult4 = "异常";
//            var strExamDate4 = OCX.GetObjectInfo("DateTime_3", "text");
//            strExamDate4 = strExamDate4.substring(0, strExamDate4.length-3);
//            if ("///" != strExamDate4 && "" == strExamResult4) 
//            {
//                strChiefComplaint += "曾于" + strExamDate4 + "做过" + strExamName4 + "，检查结果" + strExamResult4 + "；";
//            }
//            else if ("///" == strExamDate4 && "" == strExamResult4) 
//            {
//                strChiefComplaint += "做过" + strExamName4 + "，检查结果" + strExamResult4 + "；";
//            }
                    
            //get PreviousDrug
            var strDrugCategory1 = OCX.GetObjectInfo("ComboBox_46", "text");
//            var strDrugName1 = OCX.GetObjectInfo("TextBox_52", "text");
//            if("" == strDrugName1)
//                strDrugName1 = " ";
            var strDayAmoutnPerM1 = OCX.GetObjectInfo("TextBox_51", "text");
            if("" == strDayAmoutnPerM1)
                strDayAmoutnPerM1 = " ";
            var strMonthTotalAmount1 = OCX.GetObjectInfo("TextBox_50", "text");
            if("" == strMonthTotalAmount1)
                strMonthTotalAmount1 = " ";
            if("" != strDrugCategory1)
            {
                strChiefComplaint += "曾服用" + strDrugCategory1 + "，每月服药" + strDayAmoutnPerM1 + "天，连续服药" + strMonthTotalAmount1 + "个月；";
            }
                    
            var strDrugCategory2 = OCX.GetObjectInfo("ComboBox_45", "text");
//            var strDrugName2 = OCX.GetObjectInfo("TextBox_41", "text");
//            if("" == strDrugName2)
//                strDrugName2 = " ";
            var strDayAmoutnPerM2 = OCX.GetObjectInfo("TextBox_44", "text");
            if("" == strDayAmoutnPerM2)
                strDayAmoutnPerM2 = " ";
            var strMonthTotalAmount2 = OCX.GetObjectInfo("TextBox_49", "text");
            if("" == strMonthTotalAmount2)
                strMonthTotalAmount2 = " ";
            if("" != strDrugCategory2)
            {
                strChiefComplaint += "曾服用" + strDrugCategory2 + "，每月服药" + strDayAmoutnPerM2 + "天，连续服药" + strMonthTotalAmount2 + "个月；";
            }
                    
            var strDrugCategory3 = OCX.GetObjectInfo("ComboBox_44", "text");
//            var strDrugName3 = OCX.GetObjectInfo("TextBox_42", "text");
//            if("" == strDrugName3)
//                strDrugName3 = " ";
            var strDayAmoutnPerM3 = OCX.GetObjectInfo("TextBox_45", "text");
            if("" == strDayAmoutnPerM3)
                strDayAmoutnPerM3 = " ";
            var strMonthTotalAmount3 = OCX.GetObjectInfo("TextBox_48", "text");
            if("" == strMonthTotalAmount3)
                strMonthTotalAmount3 = " ";
            if("" != strDrugCategory3)
            {
                strChiefComplaint += "曾服用" + strDrugCategory3 + "，每月服药" + strDayAmoutnPerM3 + "天，连续服药" + strMonthTotalAmount3 + "个月；";
            }
            
            //获取预防类药物信息
                var strPNLR="";
                var strMTLR="";
                var strFGLQ="";
                var strBWS="";
                var strTBZ=""
                var strATL=""
                var strDRLZ=""
                var strQT=""
                var strNMDP="";
                var strNYZ="";
                var strL="";
                var strLBT="";
                var strADP="";
                var strQLP="";
                var strWFLX="";
                var strMDP="";
                var strNFCT="";
                 var strAFTT="";
                var strDLHT="";
                var strZY="";
 
                 if("true" == OCX.GetObjectInfo("CheckBox_36", "checked"))
                 strPNLR="普萘罗尔";
                 if("true" == OCX.GetObjectInfo("CheckBox_37", "checked"))
                 strMTLR="、美托洛尔";
                 if("true" == OCX.GetObjectInfo("CheckBox_38", "checked"))
                 strFGLQ="、氟桂利嗪";
                  if("true" == OCX.GetObjectInfo("CheckBox_40", "checked"))
                  strBWS="、丙戊酸"
                  if("true" == OCX.GetObjectInfo("CheckBox_39", "checked"))
                  strTBZ="、托吡酯";
                  if("true" == OCX.GetObjectInfo("CheckBox_53", "checked"))
                  strATL="、阿替洛";
                  if("true" == OCX.GetObjectInfo("CheckBox_54", "checked"))
                  strDRLZ="、地尔硫卓";
                  if("true" == OCX.GetObjectInfo("CheckBox_58", "checked"))
                  strNMDP="、尼莫地平";
                  if("true" == OCX.GetObjectInfo("CheckBox_57", "checked"))
                  strNYZ="、脑益嗪";
                  if("true" == OCX.GetObjectInfo("CheckBox_56", "checked"))
                  strL="、锂";
                  if("true" == OCX.GetObjectInfo("CheckBox_55", "checked"))
                  strLBT="、利培酮";
                  if("true" == OCX.GetObjectInfo("CheckBox_59", "checked"))
                  strADP="、奥氮平"
                  if("true" == OCX.GetObjectInfo("CheckBox_60", "checked"))
                  strQLP="、喹硫平";
                  if("true" == OCX.GetObjectInfo("CheckBox_63", "checked"))
                  strWFLX="、文拉法辛";
                  if("true" == OCX.GetObjectInfo("CheckBox_83", "checked"))
                  strMDP="、米氮平"
                  if("true" == OCX.GetObjectInfo("CheckBox_82", "checked"))
                  strNFCT="、萘发唑酮";
                  if("true" == OCX.GetObjectInfo("CheckBox_81", "checked"))
                  strAFTT="、安非他酮";
                  if("true" == OCX.GetObjectInfo("CheckBox_86", "checked"))
                  strDLHT="、丁螺环酮"
                  if("true" == OCX.GetObjectInfo("CheckBox_85", "checked"))
                  strZY="、中药";
                  if("true" == OCX.GetObjectInfo("CheckBox_84", "checked"))
                  strQT="其他";
            if("" !=strPNLR+strMTLR+ strFGLQ+strTBZ+strBWS+strTBZ+strATL+strDRLZ+strNMDP+strNYZ+strL+strLBT+strADP+strQLP+strWFLX+strMDP+strNFCT+ strAFTT+strDLHT+strZY )
                strChiefComplaint += "曾服用预防类药物"+strPNLR+strMTLR+ strFGLQ+strTBZ+strBWS+strTBZ+strATL+strDRLZ+strNMDP+strNYZ+strL+strLBT+strADP+strQLP+strWFLX+strMDP+strNFCT+ strAFTT+strDLHT+strZY;
            //Get HeadacheFamilyMember
            var strFuQin = "";
            var strMuQin = "";
            var strXiongDi = "";
            var strJieMei = "";
            var strErZi = "";
            var strNvEr = "";
            var strZuFu = "";
            var strZiMu = "";
            var strWaiZuFu = "";
            var strWaiZuMu = "";
            var strHFamilyMemberQiTa = "";
            if("true" == OCX.GetObjectInfo("CheckBox_80", "checked"))
                strFuQin = "父亲、";
            if("true" == OCX.GetObjectInfo("CheckBox_75", "checked"))
                strMuQin = "母亲、";
            if("true" == OCX.GetObjectInfo("CheckBox_74", "checked"))
                strXiongDi = "兄弟、";
            if("true" == OCX.GetObjectInfo("CheckBox_70", "checked"))
                strJieMei = "姐妹、";
            if("true" == OCX.GetObjectInfo("CheckBox_79", "checked"))
                strErZi = "儿子、";
            if("true" == OCX.GetObjectInfo("CheckBox_76", "checked"))
                strNvEr = "女儿、";
            if("true" == OCX.GetObjectInfo("CheckBox_73", "checked"))
                strZuFu = "祖父、";
            if("true" == OCX.GetObjectInfo("CheckBox_71", "checked"))
                strZiMu = "祖母、";
            if("true" == OCX.GetObjectInfo("CheckBox_78", "checked"))
                strWaiZuFu = "外祖父、";
            if("true" == OCX.GetObjectInfo("CheckBox_77", "checked"))
                strWaiZuMu = "外祖母、";
            if("true" == OCX.GetObjectInfo("CheckBox_72", "checked"))
                strHFamilyMemberQiTa = "其他";
            strChiefComplaint += "。";
            if("" != strFuQin + strMuQin + strXiongDi + strJieMei + strErZi + strNvEr + strZuFu + strZiMu + strWaiZuFu + strWaiZuMu + strHFamilyMemberQiTa)
                strChiefComplaint += strFuQin + strMuQin + strXiongDi + strJieMei + strErZi + strNvEr + strZuFu + strZiMu + strWaiZuFu + strWaiZuMu + strHFamilyMemberQiTa + "有类似头痛。";
               
            //get Precipitating Factor
            //set Chief Complaint    
            var strPrecipitatingFactor1 = "";
            var strPrecipitatingFactor2 = "";
            var strPrecipitatingFactor3 = "";
            var strPrecipitatingFactor4 = ""; 
            var strPrecipitatingFactor5 = "";
            var strPrecipitatingFactor6 = "";
            var strPrecipitatingFactor7 = "";
            var strPrecipitatingFactor8 = "";
            var strPrecipitatingFactor9 = "";
            var strPrecipitatingFactor10 = "";
            var strPrecipitatingFactorDetail1 = OCX.GetObjectInfo("ComboBox_69", "text");
            var strPrecipitatingFactorDetail2 = OCX.GetObjectInfo("ComboBox_70", "text");
            var strPrecipitatingFactorDetail3 = OCX.GetObjectInfo("ComboBox_71", "text");
            var strPrecipitatingFactorDetail4 = OCX.GetObjectInfo("ComboBox_72", "text");
            var strPrecipitatingFactorDetail5 = OCX.GetObjectInfo("ComboBox_73", "text");
            var strPrecipitatingFactorDetail6 = OCX.GetObjectInfo("ComboBox_65", "text");
            var strPrecipitatingFactorDetail7 = OCX.GetObjectInfo("ComboBox_66", "text");
            var strPrecipitatingFactorDetail8 = OCX.GetObjectInfo("ComboBox_67", "text");
            var strPrecipitatingFactorDetail9 = OCX.GetObjectInfo("ComboBox_68", "text");
            var strPrecipitatingFactorDetail10 = OCX.GetObjectInfo("TextBox_65", "text");   
            if("无" != strPrecipitatingFactorDetail1 || "无" != strPrecipitatingFactorDetail2 || "无" != strPrecipitatingFactorDetail3
            || "无" != strPrecipitatingFactorDetail4 || "无" != strPrecipitatingFactorDetail5 || "无" != strPrecipitatingFactorDetail6
            || "无" != strPrecipitatingFactorDetail7 || "无" != strPrecipitatingFactorDetail8 || "无" != strPrecipitatingFactorDetail9
            || "" != strPrecipitatingFactorDetail10)  
            {  
                strChiefComplaint += " 多于";               
                if("无" != strPrecipitatingFactorDetail1)
                {
                    //strChiefComplaint += " " + "睡眠";
                    strChiefComplaint += "睡眠不佳、";
                }
                if("无" != strPrecipitatingFactorDetail2)
                {
                    //strChiefComplaint += " " + "感觉刺激";
                    strChiefComplaint += strPrecipitatingFactorDetail2 + "、";
                }
                if("无" != strPrecipitatingFactorDetail3)
                {
                    strChiefComplaint += "紧张/情绪波动" + "、";
                }
                if("无" != strPrecipitatingFactorDetail4)
                {
                    //strChiefComplaint += " " + "食物";
                    strChiefComplaint += strPrecipitatingFactorDetail4 + "、";
                }
                if("无" != strPrecipitatingFactorDetail5)
                {
                    //strChiefComplaint += " " + "活动";
                    strChiefComplaint += strPrecipitatingFactorDetail5 + "、";
                }
                if("无" != strPrecipitatingFactorDetail6)
                {
                    //strChiefComplaint += " " + "气候";
                    strChiefComplaint += strPrecipitatingFactorDetail6 + "、";
                }
                if("无" != strPrecipitatingFactorDetail7)
                {
                    strChiefComplaint += "疲劳/放松" + "、";
                }
                if("无" != strPrecipitatingFactorDetail8)
                {
                    //strChiefComplaint += " " + "激素变化";
                    strChiefComplaint += strPrecipitatingFactorDetail8 + "、";
                }
                if("无" != strPrecipitatingFactorDetail9)
                {
                    //strChiefComplaint += " " + "体位";
                    strChiefComplaint += strPrecipitatingFactorDetail9 + "、";
                }
                if("" != strPrecipitatingFactorDetail10)
                {
                    //strChiefComplaint += " " + "其他";
                    strChiefComplaint += strPrecipitatingFactorDetail10;
                }
                strChiefComplaint += "后诱发。";
            }
                    
            //get Mitigating information
            //set Chief Complaint
            if("有" == OCX.GetObjectInfo("ComboBox_60", "text") || "有" == OCX.GetObjectInfo("ComboBox_61", "text") 
            || "有" == OCX.GetObjectInfo("ComboBox_62", "text") || "有" == OCX.GetObjectInfo("ComboBox_63", "text")
            || "有" == OCX.GetObjectInfo("ComboBox_64", "text") || "有" == OCX.GetObjectInfo("ComboBox_56", "text")
            || "有" == OCX.GetObjectInfo("ComboBox_57", "text") || "有" == OCX.GetObjectInfo("ComboBox_58", "text")
            || "有" == OCX.GetObjectInfo("ComboBox_59", "text") || "" != OCX.GetObjectInfo("TextBox_64", "text"))
            {
                strChiefComplaint += " 多于";
                if("有" == OCX.GetObjectInfo("ComboBox_60", "text"))
                    strChiefComplaint += "躺下" + "、";
                if("有" == OCX.GetObjectInfo("ComboBox_61", "text"))
                    strChiefComplaint += "黑暗/安静的房间" + "、";
                if("有" == OCX.GetObjectInfo("ComboBox_62", "text"))
                    strChiefComplaint += "按摩" + "、";
                if("有" == OCX.GetObjectInfo("ComboBox_63", "text"))
                    strChiefComplaint += "热敷" + "、";
                if("有" == OCX.GetObjectInfo("ComboBox_64", "text"))
                    strChiefComplaint += "冷敷" + "、";
                if("有" == OCX.GetObjectInfo("ComboBox_56", "text"))
                    strChiefComplaint += "快步走" + "、";
                if("有" == OCX.GetObjectInfo("ComboBox_57", "text"))
                    strChiefComplaint += "锻炼" + "、";
                if("有" == OCX.GetObjectInfo("ComboBox_58", "text"))
                    strChiefComplaint += "站立" + "、";
                if("有" == OCX.GetObjectInfo("ComboBox_59", "text"))
                    strChiefComplaint += "妊娠" + "、";
                if("" != OCX.GetObjectInfo("TextBox_64", "text"))
                    strChiefComplaint += OCX.GetObjectInfo("TextBox_64", "text");
                strChiefComplaint += "后缓解。";
            }

            strChiefComplaint += "\n";
            strChiefComplaint += "曾诊断为：" + OCX.GetObjectInfo("ComboBox_2", "text");
        }
        return strChiefComplaint;
    }
   
   function GetDoctorAdvice(OCX)
    {
        var strDoctorAdvice = "";
        if("" != OCX.GetObjectInfo("TextBox_70", "text"))
        {
            strDoctorAdvice += OCX.GetObjectInfo("TextBox_70", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("TextBox_101", "text");
            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_77", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_74", "text");
            strDoctorAdvice += "\n";
        }

        if("" != OCX.GetObjectInfo("TextBox_69", "text"))
        {
            strDoctorAdvice += OCX.GetObjectInfo("TextBox_69", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("TextBox_100", "text");
            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_76", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_55", "text");
            strDoctorAdvice += "\n";
        }

        if("" != OCX.GetObjectInfo("TextBox_68", "text"))
        {
            strDoctorAdvice += OCX.GetObjectInfo("TextBox_68", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("TextBox_99", "text");
            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_75", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_54", "text");
            strDoctorAdvice += "\n";
        }

        if("" != OCX.GetObjectInfo("TextBox_60", "text"))
        {
            strDoctorAdvice += OCX.GetObjectInfo("TextBox_60", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("TextBox_95", "text");
            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_3", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_4", "text");
            strDoctorAdvice += "\n";
        }

        if("" != OCX.GetObjectInfo("TextBox_4", "text"))
        {
            strDoctorAdvice += OCX.GetObjectInfo("TextBox_4", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("TextBox_94", "text");
            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_6", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_5", "text");
            strDoctorAdvice += "\n";
        }

        if("" != OCX.GetObjectInfo("TextBox_61", "text"))
        {
            strDoctorAdvice += OCX.GetObjectInfo("TextBox_61", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("TextBox_93", "text");
            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_30", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_29", "text");
            strDoctorAdvice += "\n";
        }

        if("" != OCX.GetObjectInfo("TextBox_73", "text"))
        {
            strDoctorAdvice += OCX.GetObjectInfo("TextBox_73", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("TextBox_86", "text");
            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_78", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_83", "text");
            strDoctorAdvice += "\n";
        }

        if("" != OCX.GetObjectInfo("TextBox_72", "text"))
        {
            strDoctorAdvice += OCX.GetObjectInfo("TextBox_72", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("TextBox_85", "text");
            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_79", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_82", "text");
            strDoctorAdvice += "\n";
        }

        if("" != OCX.GetObjectInfo("TextBox_71", "text"))
        {
            strDoctorAdvice += OCX.GetObjectInfo("TextBox_71", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("TextBox_84", "text");
            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_80", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_81", "text");
            strDoctorAdvice += "\n";
        }

        if("" != OCX.GetObjectInfo("TextBox_76", "text"))
        {
            strDoctorAdvice += OCX.GetObjectInfo("TextBox_76", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("TextBox_81", "text");
            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_84", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_89", "text");
            strDoctorAdvice += "\n";
        }

        if("" != OCX.GetObjectInfo("TextBox_75", "text"))
        {
            strDoctorAdvice += OCX.GetObjectInfo("TextBox_75", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("TextBox_82", "text");
            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_85", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_88", "text");
            strDoctorAdvice += "\n";
        }

        if("" != OCX.GetObjectInfo("TextBox_74", "text"))
        {
            strDoctorAdvice += OCX.GetObjectInfo("TextBox_74", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("TextBox_83", "text");
            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_86", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_87", "text");
            strDoctorAdvice += "\n";
        }

        if("" != OCX.GetObjectInfo("TextBox_67", "text"))
        {
            strDoctorAdvice += OCX.GetObjectInfo("TextBox_67", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("TextBox_104", "text");
            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_51", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_50", "text");
            strDoctorAdvice += "\n";
        }

        if("" != OCX.GetObjectInfo("TextBox_66", "text"))
        {
            strDoctorAdvice += OCX.GetObjectInfo("TextBox_66", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("TextBox_103", "text");
            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_52", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_43", "text");
            strDoctorAdvice += "\n";
        }

        if("" != OCX.GetObjectInfo("TextBox_63", "text"))
        {
            strDoctorAdvice += OCX.GetObjectInfo("TextBox_63", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("TextBox_102", "text");
            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_53", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_42", "text");
            strDoctorAdvice += "\n";
        }

        if("" != OCX.GetObjectInfo("TextBox_79", "text"))
        {
            strDoctorAdvice += OCX.GetObjectInfo("TextBox_79", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("TextBox_107", "text");
            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_90", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_95", "text");
            strDoctorAdvice += "\n";
        }

        if("" != OCX.GetObjectInfo("TextBox_78", "text"))
        {
            strDoctorAdvice += OCX.GetObjectInfo("TextBox_78", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("TextBox_106", "text");
            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_91", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_94", "text");
            strDoctorAdvice += "\n";
        }

        if("" != OCX.GetObjectInfo("TextBox_77", "text"))
        {
            strDoctorAdvice += OCX.GetObjectInfo("TextBox_77", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("TextBox_105", "text");
            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_92", "text");
            strDoctorAdvice += " ";

            strDoctorAdvice += OCX.GetObjectInfo("ComboBox_93", "text");
            strDoctorAdvice += "\n";
        }

        return strDoctorAdvice;
    }
    function SetDiagnosisIntoOCX(OCX, strItemName1, strItemName2,strDiagnose)
    {
        if(strDiagnose.indexOf("偏头痛") >= 0)
        {
            OCX.SetObjectInfo(strItemName1, "text", "偏头痛");
            if(strDiagnose.indexOf("很可能的偏头痛") >= 0)
            {
                OCX.SetObjectInfo(strItemName2, "text", "很可能的偏头痛");
            }
            else if(strDiagnose.indexOf("无先兆性偏头痛") >= 0)
            {
                OCX.SetObjectInfo(strItemName2, "text", "无先兆性偏头痛");
            }
            else if(strDiagnose.indexOf("先兆性偏头痛") >= 0)
            {
                OCX.SetObjectInfo(strItemName2, "text", "先兆性偏头痛");
            }
            else if(strDiagnose.indexOf("视网膜性偏头痛") >= 0)
            {
                OCX.SetObjectInfo(strItemName2, "text", "视网膜性偏头痛");
            }
            else if(strDiagnose.indexOf("偏头痛的合并症") >= 0)
            {
                OCX.SetObjectInfo(strItemName2, "text", "偏头痛的合并症");
            }
        }
        else if(strDiagnose.indexOf("紧张型头痛") >= 0)
        {
            OCX.SetObjectInfo(strItemName1, "text", "紧张型头痛");
            if(strDiagnose.indexOf("偶尔发作性紧张型头痛") >= 0)
            {
                OCX.SetObjectInfo(strItemName2, "text", "偶尔发作性紧张型头痛");
            }
            else if(strDiagnose.indexOf("频繁发作性紧张型头痛") >= 0)
            {
                OCX.SetObjectInfo(strItemName2, "text", "频繁发作性紧张型头痛");
            }
            else if(strDiagnose.indexOf("很可能的紧张型头痛") >= 0)
            {
                OCX.SetObjectInfo(strItemName2, "text", "很可能的紧张型头痛");
            }
        }
        else if(strDiagnose.indexOf("丛集性头痛") >= 0)
        {
            OCX.SetObjectInfo(strItemName1, "text", "丛集性头痛和其他原发性三叉神经痛");
            OCX.SetObjectInfo(strItemName2, "text", "丛集性头痛");
        }
        else if(strDiagnose.indexOf("阵发性偏侧头痛") >= 0)
        {
            OCX.SetObjectInfo(strItemName1, "text", "丛集性头痛和其他原发性三叉神经痛");
            OCX.SetObjectInfo(strItemName2, "text", "阵发性偏侧头痛");
        }
        else if(strDiagnose.indexOf("SUNCT") >= 0)
        {
            OCX.SetObjectInfo(strItemName1, "text", "丛集性头痛和其他原发性三叉神经痛");
            OCX.SetObjectInfo(strItemName2, "text", "SUNCT");
        }
        else if(strDiagnose.indexOf("很可能的三叉自主神经性头痛") >= 0)
        {
            OCX.SetObjectInfo(strItemName1, "text", "丛集性头痛和其他原发性三叉神经痛");
            OCX.SetObjectInfo(strItemName2, "text", "很可能的三叉自主神经性头痛");
        }
        else if(strDiagnose.indexOf("慢性偏头痛") >= 0)
        {
            OCX.SetObjectInfo(strItemName1, "text", "慢性每日头痛");
            OCX.SetObjectInfo(strItemName2, "text", "慢性偏头痛");
        }
        else if(strDiagnose.indexOf("慢性紧张型头痛") >= 0)
        {
            OCX.SetObjectInfo(strItemName1, "text", "慢性每日头痛");
            OCX.SetObjectInfo(strItemName2, "text", "慢性紧张型头痛");
        }
        else if(strDiagnose.indexOf("新发每日持续性头痛") >= 0)
        {
            OCX.SetObjectInfo(strItemName1, "text", "慢性每日头痛");
            OCX.SetObjectInfo(strItemName2, "text", "新发每日持续性头痛");
        }
        else if(strDiagnose.indexOf("药物滥用引起的头痛") >= 0)
        {
            OCX.SetObjectInfo(strItemName1, "text", "慢性每日头痛");
            OCX.SetObjectInfo(strItemName2, "text", "药物滥用引起的头痛");
        }
        else if(strDiagnose.indexOf("颅神经痛和中枢源性面痛") >= 0)
        {
            OCX.SetObjectInfo(strItemName1, "text", "颅神经痛和中枢源性面痛");
        }
    }
</script>
